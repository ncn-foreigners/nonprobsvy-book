[
  {
    "objectID": "mi.html",
    "href": "mi.html",
    "title": "4  Mass imputation",
    "section": "",
    "text": "\\[\n\\newcommand{\\bSigma}{\\boldsymbol{\\Sigma}}\n\\newcommand{\\bOmega}{\\boldsymbol{\\Omega}}\n\\newcommand{\\bTheta}{\\boldsymbol{\\Theta}}\n\\newcommand{\\bPi}{\\boldsymbol{\\Pi}}\n\\newcommand{\\bbeta}{\\boldsymbol{\\beta}}\n\\newcommand{\\balpha}{\\boldsymbol{\\alpha}}\n\\newcommand{\\brho}{\\boldsymbol{\\rho}}\n\\newcommand{\\beps}{\\boldsymbol{\\epsilon}}\n\\newcommand{\\blambda}{\\boldsymbol{\\lambda}}\n\\newcommand{\\bgamma}{\\boldsymbol{\\gamma}}\n\\newcommand{\\btheta}{\\boldsymbol{\\theta}}\n\\newcommand{\\bmu}{\\boldsymbol{\\mu}}\n\\newcommand{\\bpi}{\\boldsymbol{\\pi}}\n\\newcommand{\\bphi}{\\boldsymbol{\\phi}}\n\\newcommand{\\bPhi}{\\boldsymbol{\\Phi}}\n\\newcommand{\\boldeta}{\\boldsymbol{\\eta}}\n\\newcommand{\\bx}{\\boldsymbol{x}}\n\\newcommand{\\bD}{\\boldsymbol{D}}\n\\newcommand{\\bV}{\\boldsymbol{V}}\n\\newcommand{\\bv}{\\boldsymbol{v}}\n\\newcommand{\\bY}{\\boldsymbol{Y}}\n\\newcommand{\\bA}{\\boldsymbol{A}}\n\\newcommand{\\bB}{\\boldsymbol{B}}\n\\newcommand{\\bR}{\\boldsymbol{R}}\n\\newcommand{\\bM}{\\boldsymbol{M}}\n\\newcommand{\\bI}{\\boldsymbol{I}}\n\\newcommand{\\bC}{\\boldsymbol{C}}\n\\newcommand{\\bW}{\\boldsymbol{W}}\n\\newcommand{\\bw}{\\boldsymbol{w}}\n\\newcommand{\\bd}{\\boldsymbol{d}}\n\\newcommand{\\bT}{\\boldsymbol{T}}\n\\newcommand{\\bt}{\\boldsymbol{t}}\n\\newcommand{\\bZ}{\\boldsymbol{Z}}\n\\newcommand{\\bX}{\\boldsymbol{X}}\n\\newcommand{\\bz}{\\boldsymbol{z}}\n\\newcommand{\\by}{\\boldsymbol{y}}\n\\newcommand{\\br}{\\boldsymbol{r}}\n\\newcommand{\\bp}{\\boldsymbol{p}}\n\\newcommand{\\bb}{\\boldsymbol{b}}\n\\newcommand{\\bZero}{\\boldsymbol{0}}\n\\newcommand{\\bOne}{\\boldsymbol{1}}\n\\]"
  },
  {
    "objectID": "mi.html#motivation-and-assumptions",
    "href": "mi.html#motivation-and-assumptions",
    "title": "4  Mass imputation",
    "section": "4.1 Motivation and assumptions",
    "text": "4.1 Motivation and assumptions\nThis method relies on framework, where imputed values of the outcome variables are created for whole probability sample (\\(S_B\\)). In this case we treat big-data sample (\\(S_A\\)) as a training dataset, which is used to build an imputation model. The mass imputation approach for inference with non-probability samples makes use of model-based prediction methods, but it opens the door for more flexible methods as well. We consider parametric (e.g. regression models) and non-parametric (nearest neighbor algorithm) methods for this problem. General framework consists of building a model based on the \\(S_A\\) sample and for each \\(i \\in S_A\\) calculate imputed value."
  },
  {
    "objectID": "mi.html#model-based-methods",
    "href": "mi.html#model-based-methods",
    "title": "4  Mass imputation",
    "section": "4.2 Model-based methods",
    "text": "4.2 Model-based methods\nThis method is based on parametric model on sample \\(S_A\\) in the form of\n\\[\n\\begin{equation}\n\\mathbb{E}\\left(y_i \\mid \\bx_i\\right) = m\\left(\\bx_i, \\bbeta_{0}\\right)\n\\end{equation}\n\\]\nfor some unknown \\(\\bbeta_{0}\\) and known function \\(m(\\cdot)\\). The specification of m-function typically follows the mean function for generalized linear models. If \\(\\by\\) is continous, we can use linear regression model with \\(m\\left(\\boldsymbol{x}_i, \\bbeta_{0}\\right) = \\bx_i^{T} \\bbeta_0\\). If \\(\\by\\) is binary, one can use logistic regression model and let \\(m\\left(\\boldsymbol{x}_i, \\bbeta_{0}\\right) = \\frac{\\exp\\left( \\bx_i^{T} \\bbeta_0\\right)}{\\exp\\left( \\bx_i^{T} \\bbeta_0\\right) + 1}\\). If \\(\\by\\) represents count data, we can use log-linear model, where \\(m\\left(\\boldsymbol{x}_i, \\bbeta_{0}\\right) = \\exp\\left(\\bx_i^{T} \\bbeta_0\\right)\\).\nBasing on this approach we can obtain another approach for population mean estimator. It is worth noting that this time we rely on known design weights and imputation model for units from probability samples. \\[\n\\begin{equation}\n\\frac{1}{\\hat{N}^{\\mathrm{B}}} \\sum_{i \\in \\mathcal{S}_{\\mathrm{B}}} d_i^{\\mathrm{B}} m\\left(\\boldsymbol{x}_i, \\hat{\\bbeta}\\right)\n\\end{equation}\n\\] Theoretical calculations lead to the following variance of the estimator, where the second part is variance of the widely-known Horvits-Thompson population mean estimator, which is implemented in the R survey package.\n\\[\n\\text{var}\\left(\\hat{\\mu}_{MI}\\right) = \\text{var}_A + \\text{var}_B\n\\] The \\(\\text{var}_A\\) can be estimated by \\[\n\\text{var}_A = \\frac{1}{n_A} \\sum_{i \\in S_A} \\hat{e}_i^2 \\left(\\bx_i^{T} \\hat{c}\\right)^2,\n\\] where \\(\\hat{e_i} = y_i - m\\left(\\boldsymbol{x}_i, \\hat{\\bbeta}\\right)\\) and \\(\\hat{c} = \\left\\{\\frac{1}{n_A} \\sum_{i \\in S_A} \\dot{m}\\left(\\boldsymbol{x}_i, \\hat{\\bbeta}\\right) \\bx_i^T \\right\\}^{-1} N^{-1} \\sum_{i \\in S_B} d_i^B \\bx_i\\). Respectively \\(\\text{var}_B\\) can be estimated by \\[\n\\hat{\\text{var}}_B = \\frac{1}{N^2} \\sum_{i \\in \\mathcal{S}_{\\mathrm{B}}} \\sum_{j \\in \\mathcal{S}_{\\mathrm{B}}} \\frac{\\pi_{i j}^{\\mathrm{B}}-\\pi_i^{\\mathrm{B}} \\pi_j^{\\mathrm{B}}}{\\pi_{i j}^{\\mathrm{B}}} d_i^B m\\left(\\boldsymbol{x}_i, \\hat{\\bbeta}\\right) d_j^B m\\left(\\boldsymbol{x}_j, \\hat{\\bbeta}\\right)\n\\]"
  },
  {
    "objectID": "mi.html#nearest-neighbor-imputation",
    "href": "mi.html#nearest-neighbor-imputation",
    "title": "4  Mass imputation",
    "section": "4.3 Nearest neighbor imputation",
    "text": "4.3 Nearest neighbor imputation\nOn the other hand we can applied non-parametric method to this problem, such as nearest neighbor algorithm, that is, find the closest matching unit from sample \\(S_B\\) based on the \\(\\bx\\) values and use the corresponding \\(\\by\\) value from this unit as the imputed value.\n\n4.3.1 Assumptions\n\n\n4.3.2 Model\nProcedure contains two steps\n\nfor each \\(i \\in S_B\\) find the nearest neighbor from sample \\(S_A\\).\nCalculate the nearest neighbor imputation estimator of \\(\\mu_y\\) \\[\n\\begin{equation}\n\\hat{\\mu}_\\mathrm{nn}=\\frac{1}{N} \\sum_{i \\in S_B} d_i^B y_{i(1)} .\n\\end{equation}\n\\]\n\nThis methods can provide robust results, but suffers from so called curse of dimensionanlity. For \\(p > 1\\) asymptotic bias of the estimator is not negligible (Yang and Kim, 2020). Variance of an estimator\nWe have \\[\nV_{\\mathrm{nni}}=\\lim _{n \\rightarrow \\infty} \\frac{n}{N^2} E\\left[\\operatorname{var}_p\\left\\{\\sum_{i \\in S_B} d_i^B g\\left(y_i\\right)\\right\\}\\right] .\n\\]\nwhich can be estimated by \\[\n\\hat{\\text{var}}_{\\mathrm{nni}}=\\frac{n}{N^2} \\sum_{i \\in S_A} \\sum_{j \\in S_A} \\frac{\\pi_{i j}-\\pi_i \\pi_j}{\\pi_i \\pi_j} \\frac{y_{i(1)}}{\\pi_i} \\frac{y_{j(1)}}{\\pi_j}\n\\]"
  },
  {
    "objectID": "mi.html#k-nearest-neighbor-imputation",
    "href": "mi.html#k-nearest-neighbor-imputation",
    "title": "4  Mass imputation",
    "section": "4.4 K-nearest neighbor imputation",
    "text": "4.4 K-nearest neighbor imputation\nSteps\n\nFor each unit \\(i \\in S_B\\) find k-nearest neighbors from sample \\(S_A\\). Impute the \\(\\by\\) value for unit \\(i\\) by \\(\\hat{\\mu}\\left(\\mathbf{x}_i\\right)=k^{-1} \\sum_{j=1}^k y_{i(j)}\\).\nCalculate k-nearest neighbor imputation estimator of \\(\\mu_y\\) \\[\n\\hat{\\mu}_{\\mathrm{knn}}=\\frac{1}{N} \\sum_{i \\in S_B} d_i^B \\hat{\\mu}\\left(\\mathbf{x}_i\\right) .\n\\]\n\nVariance of an estimator\nWe have\n\\[\n\\text{var}_{\\mathrm{knn}}=\\lim _{n \\rightarrow \\infty} \\frac{n}{N^2}\\left(E\\left[\\operatorname{var}_p\\left\\{\\sum_{i \\in S_B} d_i^B \\mu\\left(\\bx_i\\right)\\right\\}\\right]+E\\left\\{\\frac{1-\\pi_A(\\bx)}{\\pi_A(\\bx)} \\sigma^2(\\bx)\\right\\}\\right),\n\\] where \\(\\sigma^2(\\bx)=\\operatorname{var}\\{y \\mid \\bx\\}\\) and \\(\\pi_A(\\bx) = P\\left(R_i=1 \\mid \\boldsymbol{x}\\right)\\)"
  },
  {
    "objectID": "dr.html",
    "href": "dr.html",
    "title": "5  Doubly robust methods",
    "section": "",
    "text": "\\[\n\\newcommand{\\bSigma}{\\boldsymbol{\\Sigma}}\n\\newcommand{\\bOmega}{\\boldsymbol{\\Omega}}\n\\newcommand{\\bTheta}{\\boldsymbol{\\Theta}}\n\\newcommand{\\bPi}{\\boldsymbol{\\Pi}}\n\\newcommand{\\bbeta}{\\boldsymbol{\\beta}}\n\\newcommand{\\balpha}{\\boldsymbol{\\alpha}}\n\\newcommand{\\brho}{\\boldsymbol{\\rho}}\n\\newcommand{\\beps}{\\boldsymbol{\\epsilon}}\n\\newcommand{\\blambda}{\\boldsymbol{\\lambda}}\n\\newcommand{\\bgamma}{\\boldsymbol{\\gamma}}\n\\newcommand{\\btheta}{\\boldsymbol{\\theta}}\n\\newcommand{\\bmu}{\\boldsymbol{\\mu}}\n\\newcommand{\\bpi}{\\boldsymbol{\\pi}}\n\\newcommand{\\bphi}{\\boldsymbol{\\phi}}\n\\newcommand{\\bPhi}{\\boldsymbol{\\Phi}}\n\\newcommand{\\boldeta}{\\boldsymbol{\\eta}}\n\\newcommand{\\bx}{\\boldsymbol{x}}\n\\newcommand{\\bD}{\\boldsymbol{D}}\n\\newcommand{\\bV}{\\boldsymbol{V}}\n\\newcommand{\\bv}{\\boldsymbol{v}}\n\\newcommand{\\bY}{\\boldsymbol{Y}}\n\\newcommand{\\bA}{\\boldsymbol{A}}\n\\newcommand{\\bB}{\\boldsymbol{B}}\n\\newcommand{\\bR}{\\boldsymbol{R}}\n\\newcommand{\\bM}{\\boldsymbol{M}}\n\\newcommand{\\bI}{\\boldsymbol{I}}\n\\newcommand{\\bC}{\\boldsymbol{C}}\n\\newcommand{\\bW}{\\boldsymbol{W}}\n\\newcommand{\\bw}{\\boldsymbol{w}}\n\\newcommand{\\bd}{\\boldsymbol{d}}\n\\newcommand{\\bT}{\\boldsymbol{T}}\n\\newcommand{\\bt}{\\boldsymbol{t}}\n\\newcommand{\\bZ}{\\boldsymbol{Z}}\n\\newcommand{\\bX}{\\boldsymbol{X}}\n\\newcommand{\\bz}{\\boldsymbol{z}}\n\\newcommand{\\by}{\\boldsymbol{y}}\n\\newcommand{\\br}{\\boldsymbol{r}}\n\\newcommand{\\bp}{\\boldsymbol{p}}\n\\newcommand{\\bb}{\\boldsymbol{b}}\n\\newcommand{\\bZero}{\\boldsymbol{0}}\n\\newcommand{\\bOne}{\\boldsymbol{1}}\n\\]\nThe IPW and MI estimators are sensible on misspecified models for propensity score and outcome variable respectively. For this purpose so called doubly-robust methoods, which take into account these problems, are presented. It is quite simple idea of combination propensity score and imputation models during inference, but in the first part of this chapter we present model which is based directly on the DR estimator."
  },
  {
    "objectID": "dr.html#bias-minimization-technique",
    "href": "dr.html#bias-minimization-technique",
    "title": "5  Doubly robust methods",
    "section": "5.1 Bias minimization technique",
    "text": "5.1 Bias minimization technique\nThis model is derived from the form of the bias of doubly robust estimator. We consider set of estimating equations, for which we want to find regression parameters (\\(\\btheta, \\bbeta\\)). Shu Yang, Jae Kwang Kim and Rui Song proposed this method with logistic regression for selection model. As before our goal is to expand this approach. At the beginning let us derive bias of the estimator. We have\n\\[\n\\begin{aligned}\nbias(\\hat{\\mu}_{DR}) = & \\mathbb{E}\\left\\{\\hat{\\mu}_{DR} - \\mu\\right\\} \\\\ = & \\mathbb{E}\\left[ \\frac{1}{N} \\sum_{i=1}^N \\left\\{\\frac{R_i^A}{\\pi_i^A \\left(\\bx_i^{\\mathrm{T}} \\btheta \\right)}  - 1\\right\\} \\left\\{y_i - \\operatorname{m}\\left( \\bx_i^{\\mathrm{T}} \\bbeta\\right)\\right\\} \\right] \\\\ + & \\mathbb{E}\\left[  \\frac{1}{N} \\sum_{i=1}^N \\left(R_i^B d_i^B - 1\\right) \\operatorname{m}\\left( \\bx_i^{\\mathrm{T}} \\bbeta \\right)\\right]\n\\end{aligned}\n\\] Since we actually care about minimizing the square of the bias, let’s calculate its derivative against the parameter vector. \\[\n\\begin{aligned}\n    \\frac{\\partial \\operatorname{bias}(\\hat{\\mu}_{DR})^2}{\\partial \\left(\\bbeta^{\\mathrm{T}}, \\btheta^{\\mathrm{T}}\\right)^{\\mathrm{T}}} = 2 \\operatorname{bias}(\\hat{\\mu}_{DR}) J(\\theta, \\beta),\n\\end{aligned}\n\\] where \\(J(\\theta, \\beta)\\) is internal derivative and depends on the model for outcome variable and propensity score. In the basic setting with propensity score modelling by logistic regression we have following system of equations to solve \\[\n\\begin{equation}\n\\begin{aligned}\nJ(\\theta, \\beta)=\\left(\\begin{array}{c}\nJ_1(\\theta, \\beta) \\\\\nJ_2(\\theta, \\beta)\n\\end{array}\\right)=\\left(\\begin{array}{c}\n\\sum_{i=1}^N R_i^A\\left\\{\\frac{1}{\\pi\\left(\\boldsymbol{x}_i, \\boldsymbol{\\theta}\\right)}-1\\right\\}\\left\\{y_i-m\\left(\\boldsymbol{x}_i, \\boldsymbol{\\beta}\\right)\\right\\} \\boldsymbol{x}_i \\\\\n\\sum_{i=1}^N \\frac{R_i^A}{\\pi\\left(\\boldsymbol{x}_i, \\boldsymbol{\\theta}\\right)} \\frac{\\partial m\\left(\\boldsymbol{x}_i, \\boldsymbol{\\beta}\\right)}{\\partial \\bbeta}  - \\sum_{i \\in \\mathcal{S}_{\\mathrm{B}}} d_i^{\\mathrm{B}} \\frac{\\partial m\\left(\\boldsymbol{x}_i, \\boldsymbol{\\beta}\\right)}{\\partial \\bbeta}\n\\end{array}\\right)\n\\end{aligned}\n\\end{equation}\n\\] where \\(\\left(\\boldsymbol{x}_i, \\boldsymbol{\\beta}\\right)\\) is working model for outcome variable, for example in linear regression case we have \\[\nm\\left(\\boldsymbol{x}_i, \\boldsymbol{\\beta}\\right) = \\bx_i^{T} \\bbeta\n\\] and \\[\n\\frac{\\partial m\\left(\\boldsymbol{x}_i, \\boldsymbol{\\beta}\\right)}{\\partial \\bbeta} = \\bx_i.\n\\] For complementary log-log model we have \\[\n\\begin{equation}\nJ(\\theta, \\beta)=\\left(\\begin{array}{c}\nJ_1(\\theta, \\beta) \\\\\nJ_2(\\theta, \\beta)\n\\end{array}\\right)=\\left(\\begin{array}{c}\n\\frac{1}{N} \\sum_{i=1}^N R_i^A\\left\\{\\frac{1 - \\pi_i^A\\left(\\bx_i^{\\mathrm{T}} \\btheta \\right)}{\\pi_i^A\\left(\\bx_i^{\\mathrm{T}} \\btheta \\right)^2} \\exp(\\bx_i^{\\mathrm{T}} \\btheta)\\right\\}\\left\\{y_i-m\\left(\\bx_i^{\\mathrm{T}} \\beta\\right)\\right\\} \\bx_i \\\\\n\\frac{1}{N} \\sum_{i=1}^N\\left\\{\\frac{R_i^A}{\\pi_i^A\\left(\\bx^{\\mathrm{T}}\\theta\\right)}-d_i^B R_i^B\\right\\} \\frac{\\partial m\\left(\\bx_i^{\\mathrm{T}} \\beta\\right)}{\\partial \\beta}\n\\end{array}\\right)\n\\end{equation}\n\\] and probit model\n\\[\n\\begin{equation}\nJ(\\theta, \\beta)=\\left(\\begin{array}{c}\nJ_1(\\theta, \\beta) \\\\\nJ_2(\\theta, \\beta)\n\\end{array}\\right)=\\left(\\begin{array}{c}\n\\frac{1}{N} \\sum_{i=1}^N R_i^A\\frac{\\dot{\\pi_i^A}\\left(\\bx_i^{\\mathrm{T}} \\btheta \\right)}{\\pi_i^A\\left(\\bx_i^{\\mathrm{T}} \\btheta \\right)^2} \\left\\{y_i-m\\left(\\bx_i^{\\mathrm{T}} \\beta\\right)\\right\\} \\bx_i \\\\\n\\frac{1}{N} \\sum_{i=1}^N\\left\\{\\frac{R_i^A}{\\pi_i^A\\left(\\bx^{\\mathrm{T}}\\theta\\right)}-d_i^B R_i^B\\right\\} \\frac{\\partial m\\left(\\bx_i^{\\mathrm{T}} \\beta\\right)}{\\partial \\beta}\n\\end{array}\\right)\n\\end{equation}\n\\]\nGoal is to solve following system of equations \\[\nJ(\\theta, \\beta)=\\bZero\n\\]"
  },
  {
    "objectID": "dr.html#population-mean-estimator-and-its-properties",
    "href": "dr.html#population-mean-estimator-and-its-properties",
    "title": "5  Doubly robust methods",
    "section": "5.2 Population mean estimator and its properties",
    "text": "5.2 Population mean estimator and its properties\nNot surprisingly, this method involves using units from both probability and non-probability samples. In particular estimator of the population mean is as follows \\[\n\\begin{equation*}\n    \\hat{\\mu}_{\\mathrm{DR}}=\\frac{1}{\\hat{N}^{\\mathrm{A}}} \\sum_{i \\in \\mathcal{S}_{\\mathrm{A}}} d_i^{\\mathrm{A}}\\left\\{y_i-m\\left(\\boldsymbol{x}_i, \\hat{\\boldsymbol{\\beta}}\\right)\\right\\}+\\frac{1}{\\hat{N}^{\\mathrm{B}}} \\sum_{i \\in \\mathcal{S}_{\\mathrm{B}}} d_i^{\\mathrm{B}} m\\left(\\boldsymbol{x}_i, \\hat{\\boldsymbol{\\beta}}\\right),\n\\end{equation*}\n\\] where \\(d_i^A = \\pi \\left(\\bx_i, \\btheta\\right)^{-1}\\), \\(\\hat{N}^A = \\sum_{i \\in S_A} d_i^A\\) and \\(\\hat{N}^B = \\sum_{i \\in S_B} d_i^B\\). We will first show how to obtain the variance of the derived estimator using separate procedures for propensity score and mass imputation (for example MLE and linear regression), and then variance derived from bias minimization technique for estimation.\n\n5.2.1 Variance estimation for separate models\nIt can be shown that parameters \\(\\bbeta\\) have no impact on asymptotic variance of \\(\\hat{\\mu}_{DR}\\). Let’s assume that \\(\\hat{\\bbeta} - \\bbeta^* = O_p(n_A^{-1/2})\\) for some fixed \\(\\bbeta^*\\). Notice that the first part of DR estimator is the \\(\\mu_{IPW2}\\) estimator with \\(y_i\\) replaced by \\(y_i - \\operatorname{m}\\left(\\bx_i,\\bbeta^*\\right)\\). Using the asymptotic expansions developed for \\(\\mu_{IPW2}\\) and logistic regression model for propensity score we have \\[\n\\begin{equation}\n\\begin{aligned}\n\\frac{1}{\\hat{N}^A} \\sum_{i=1}^N \\frac{R_i\\left\\{y_i-m\\left(\\boldsymbol{x}_i, \\boldsymbol{\\beta}^*\\right)\\right\\}}{\\hat{\\pi}_i^A}= & h_N+\\frac{1}{N} \\sum_{i=1}^N R_i\\left\\{\\frac{y_i-m\\left(\\boldsymbol{x}_i, \\boldsymbol{\\beta}^*\\right)-h_N}{\\pi_i^A}-\\mathbf{b}_3^{\\top} \\boldsymbol{x}_i\\right\\} \\\\\n& +\\mathbf{b}^{\\top} \\frac{1}{N} \\sum_{i \\in \\mathcal{S}_B} d_i^B \\pi_i^A \\boldsymbol{x}_i+o_p\\left(n_A^{-1 / 2}\\right),\n\\end{aligned}\n\\end{equation}\n\\] where \\(h_N=N^{-1} \\sum_{i=1}^N\\left\\{y_i-m\\left(\\boldsymbol{x}_i, \\boldsymbol{\\beta}^*\\right)\\right\\}\\) and\n\\[\n\\mathbf{b}^{\\top}=\\left[\\frac{1}{N} \\sum_{i=1}^N\\left(1-\\pi_i^A\\right)\\left\\{y_i-m\\left(\\boldsymbol{x}_i, \\boldsymbol{\\beta}^*\\right)-h_N\\right\\} \\boldsymbol{x}_i^{\\top}\\right]\\left\\{\\frac{1}{N} \\sum_{i=1}^N \\pi_i^A\\left(1-\\pi_i^A\\right) \\boldsymbol{x}_i \\boldsymbol{x}_i^{\\top}\\right\\}^{-1}\n\\] The second part of the estimator has the following expansion \\[\n\\frac{1}{\\hat{N}^B} \\sum_{i \\in \\mathcal{S}_B} d_i^B m\\left(\\bx_i,\\bbeta^*\\right)=\\frac{1}{N} \\sum_{i=1}^N m\\left(\\bx_i,\\bbeta^*\\right)+\\frac{1}{N} \\sum_{i \\in \\mathcal{S}_B} d_i^B\\left\\{m\\left(\\bx_i,\\bbeta^*\\right)-\\frac{1}{N} \\sum_{i=1}^N m_i\\right\\}+O_p\\left(n_B^{-1}\\right)\n\\] Further, putting these two parts together, we have \\[\n\\hat{\\mu}_{D R 2}-\\mu_y=\\frac{1}{N} \\sum_{i=1}^N R_i\\left\\{\\frac{y_i-m\\left(\\boldsymbol{x}_i, \\boldsymbol{\\beta}^*\\right)-h_N}{\\pi_i^A}-\\mathbf{b}_3^{\\top} \\boldsymbol{x}_i\\right\\}+\\frac{1}{N} \\sum_{i \\in \\mathcal{S}_B} d_i^B t_i+o_p\\left(n_A^{-1 / 2}\\right),\n\\] where \\(t_i=\\pi_i^A \\boldsymbol{x}_i^{\\top} \\mathbf{b}_3+m\\left(\\boldsymbol{x}_i, \\boldsymbol{\\beta}^*\\right)-N^{-1} \\sum_{i=1}^N m\\left(\\boldsymbol{x}_i, \\boldsymbol{\\beta}^*\\right)\\). Finally \\[\n\\begin{gathered} \\text{var}(\\hat{\\mu}_{DR}) =\n\\frac{1}{N^2} \\sum_{i=1}^N\\left(1-\\pi_i^{\\mathrm{A}}\\right) \\pi_i^{\\mathrm{A}}\\left[\\left\\{y_i-m\\left(\\boldsymbol{x}_i, \\boldsymbol{\\beta}^*\\right)-h_{\\mathrm{N}}\\right\\} /\\right. \\\\\n\\left.\\pi_i^{\\mathrm{A}}-\\mathbf{b}_3^{\\top} \\boldsymbol{x}_i\\right]^2+W,\n\\end{gathered}\n\\] where \\(W = N^{-2} \\text{var}_p\\left(\\sum_{i \\in \\mathcal{S}_{\\mathrm{B}}} d_i^{\\mathrm{B}} t_i\\right)\\).\n\n\n5.2.2 Variance estimation for bias-oriented technique\nWhen model is obtained by using systems of equations derived from bias minimization technique. We have variance decomposition on probability and nonprobability part, where \\[\n\\text{var}_B = \\mathbb{E} \\left\\{\\frac{1}{N^2} \\sum_{i \\in \\mathcal{S}_{\\mathrm{B}}} \\sum_{j \\in \\mathcal{S}_{\\mathrm{B}}} \\frac{\\pi_{i j}^{\\mathrm{B}}-\\pi_i^{\\mathrm{B}} \\pi_j^{\\mathrm{B}}}{\\pi_{i j}^{\\mathrm{B}}} d_i^B m\\left(\\boldsymbol{x}_i, \\bbeta^*\\right) d_j^B m\\left(\\boldsymbol{x}_j, \\bbeta^*\\right) \\right\\}\n\\] which can be estimated by \\[\n\\hat{\\text{var}}_B = \\frac{1}{N^2} \\sum_{i \\in \\mathcal{S}_{\\mathrm{B}}} \\sum_{j \\in \\mathcal{S}_{\\mathrm{B}}} \\frac{\\pi_{i j}^{\\mathrm{B}}-\\pi_i^{\\mathrm{B}} \\pi_j^{\\mathrm{B}}}{\\pi_{i j}^{\\mathrm{B}}} d_i^B m\\left(\\boldsymbol{x}_i, \\hat{\\bbeta}\\right) d_j^B m\\left(\\boldsymbol{x}_j, \\hat{\\bbeta}\\right)\n\\] For non-probability part we have \\[\n\\text{var}_A = \\frac{1}{N^2} \\sum_{i=1}^N \\mathbb{E} \\left[R_i^A \\left\\{ \\frac{1 - 2 \\pi_i^A}{\\left( \\pi_i^A \\right) ^2} \\right\\} \\sigma_i^2 + \\sigma_i^2 \\right]\n\\] what can be estimated by \\[\n\\hat{\\text{var}}_A = \\frac{1}{N^2} \\sum_{i=1}^N R_i^A \\left\\{ \\frac{1 - 2 \\hat{\\pi}_i^A}{\\left( \\hat{\\pi}_i^A \\right) ^2} \\right\\} \\hat{\\sigma}_i^2 + \\sum_{i \\in S_B} d_i^B \\hat{\\sigma}_i^2,\n\\] where \\(\\hat{\\sigma}_i^2\\) is consistent estimator of \\(\\sigma_i^2 = \\text{var}\\left(y_i \\mid \\bx_i\\right)\\)."
  },
  {
    "objectID": "references.html",
    "href": "references.html",
    "title": "8  References",
    "section": "",
    "text": "\\[\n\\newcommand{\\bSigma}{\\boldsymbol{\\Sigma}}\n\\newcommand{\\bOmega}{\\boldsymbol{\\Omega}}\n\\newcommand{\\bTheta}{\\boldsymbol{\\Theta}}\n\\newcommand{\\bPi}{\\boldsymbol{\\Pi}}\n\\newcommand{\\bbeta}{\\boldsymbol{\\beta}}\n\\newcommand{\\balpha}{\\boldsymbol{\\alpha}}\n\\newcommand{\\brho}{\\boldsymbol{\\rho}}\n\\newcommand{\\beps}{\\boldsymbol{\\epsilon}}\n\\newcommand{\\blambda}{\\boldsymbol{\\lambda}}\n\\newcommand{\\bgamma}{\\boldsymbol{\\gamma}}\n\\newcommand{\\btheta}{\\boldsymbol{\\theta}}\n\\newcommand{\\bmu}{\\boldsymbol{\\mu}}\n\\newcommand{\\bpi}{\\boldsymbol{\\pi}}\n\\newcommand{\\bphi}{\\boldsymbol{\\phi}}\n\\newcommand{\\bPhi}{\\boldsymbol{\\Phi}}\n\\newcommand{\\boldeta}{\\boldsymbol{\\eta}}\n\\newcommand{\\bx}{\\boldsymbol{x}}\n\\newcommand{\\bD}{\\boldsymbol{D}}\n\\newcommand{\\bV}{\\boldsymbol{V}}\n\\newcommand{\\bv}{\\boldsymbol{v}}\n\\newcommand{\\bY}{\\boldsymbol{Y}}\n\\newcommand{\\bA}{\\boldsymbol{A}}\n\\newcommand{\\bB}{\\boldsymbol{B}}\n\\newcommand{\\bR}{\\boldsymbol{R}}\n\\newcommand{\\bM}{\\boldsymbol{M}}\n\\newcommand{\\bI}{\\boldsymbol{I}}\n\\newcommand{\\bC}{\\boldsymbol{C}}\n\\newcommand{\\bW}{\\boldsymbol{W}}\n\\newcommand{\\bw}{\\boldsymbol{w}}\n\\newcommand{\\bd}{\\boldsymbol{d}}\n\\newcommand{\\bT}{\\boldsymbol{T}}\n\\newcommand{\\bt}{\\boldsymbol{t}}\n\\newcommand{\\bZ}{\\boldsymbol{Z}}\n\\newcommand{\\bX}{\\boldsymbol{X}}\n\\newcommand{\\bz}{\\boldsymbol{z}}\n\\newcommand{\\by}{\\boldsymbol{y}}\n\\newcommand{\\br}{\\boldsymbol{r}}\n\\newcommand{\\bp}{\\boldsymbol{p}}\n\\newcommand{\\bb}{\\boldsymbol{b}}\n\\newcommand{\\bZero}{\\boldsymbol{0}}\n\\newcommand{\\bOne}{\\boldsymbol{1}}\n\\]\n(Yilin Chen 2020) (Jae Kwang Kim 2020) (Kim 2022) (Shu Yang 2020)"
  },
  {
    "objectID": "appendix.html",
    "href": "appendix.html",
    "title": "Appendix A — Appendices",
    "section": "",
    "text": "\\[\n\\newcommand{\\bSigma}{\\boldsymbol{\\Sigma}}\n\\newcommand{\\bOmega}{\\boldsymbol{\\Omega}}\n\\newcommand{\\bTheta}{\\boldsymbol{\\Theta}}\n\\newcommand{\\bPi}{\\boldsymbol{\\Pi}}\n\\newcommand{\\bbeta}{\\boldsymbol{\\beta}}\n\\newcommand{\\balpha}{\\boldsymbol{\\alpha}}\n\\newcommand{\\brho}{\\boldsymbol{\\rho}}\n\\newcommand{\\beps}{\\boldsymbol{\\epsilon}}\n\\newcommand{\\blambda}{\\boldsymbol{\\lambda}}\n\\newcommand{\\bgamma}{\\boldsymbol{\\gamma}}\n\\newcommand{\\btheta}{\\boldsymbol{\\theta}}\n\\newcommand{\\bmu}{\\boldsymbol{\\mu}}\n\\newcommand{\\bpi}{\\boldsymbol{\\pi}}\n\\newcommand{\\bphi}{\\boldsymbol{\\phi}}\n\\newcommand{\\bPhi}{\\boldsymbol{\\Phi}}\n\\newcommand{\\boldeta}{\\boldsymbol{\\eta}}\n\\newcommand{\\bx}{\\boldsymbol{x}}\n\\newcommand{\\bD}{\\boldsymbol{D}}\n\\newcommand{\\bV}{\\boldsymbol{V}}\n\\newcommand{\\bv}{\\boldsymbol{v}}\n\\newcommand{\\bY}{\\boldsymbol{Y}}\n\\newcommand{\\bA}{\\boldsymbol{A}}\n\\newcommand{\\bB}{\\boldsymbol{B}}\n\\newcommand{\\bR}{\\boldsymbol{R}}\n\\newcommand{\\bM}{\\boldsymbol{M}}\n\\newcommand{\\bI}{\\boldsymbol{I}}\n\\newcommand{\\bC}{\\boldsymbol{C}}\n\\newcommand{\\bW}{\\boldsymbol{W}}\n\\newcommand{\\bw}{\\boldsymbol{w}}\n\\newcommand{\\bd}{\\boldsymbol{d}}\n\\newcommand{\\bT}{\\boldsymbol{T}}\n\\newcommand{\\bt}{\\boldsymbol{t}}\n\\newcommand{\\bZ}{\\boldsymbol{Z}}\n\\newcommand{\\bX}{\\boldsymbol{X}}\n\\newcommand{\\bz}{\\boldsymbol{z}}\n\\newcommand{\\by}{\\boldsymbol{y}}\n\\newcommand{\\br}{\\boldsymbol{r}}\n\\newcommand{\\bp}{\\boldsymbol{p}}\n\\newcommand{\\bb}{\\boldsymbol{b}}\n\\newcommand{\\bZero}{\\boldsymbol{0}}\n\\newcommand{\\bOne}{\\boldsymbol{1}}\n\\]"
  },
  {
    "objectID": "appendix.html#ipw-estimator-variance",
    "href": "appendix.html#ipw-estimator-variance",
    "title": "Appendix A — Appendices",
    "section": "A.1 IPW estimator variance",
    "text": "A.1 IPW estimator variance\nSimilarly as in second chapter wi will derive variance of an IPW estimator, but this time we will consider all of the other models for propensity score. In the first part we expand Taylor approximation for MLE model with complementary log-log and probit regression for propensity score. In the next part we this approach for variance estimation in GEE models.\n\nA.1.1 MLE (complementary log-log model)\nRecall that we have following system of equation to solve for cloglog model with corresponding objective function (gradient).\n\\[\n\\begin{equation*}\n\\boldsymbol{\\Phi}_n(\\boldsymbol{\\eta})=\\left(\\begin{array}{c}\n\\frac{1}{N} \\sum_{i=1}^N\\left[\\frac{R_i\\left(y_i-\\mu\\right)}{\\pi_i^A}+\\Delta \\frac{R_i-\\pi_i^A}{\\pi_i^A}\\right] \\\\\n\\frac{1}{N}\\sum_{i=1}^N R_i \\frac{\\exp(\\bx_{i}^{\\top}\\btheta)\\bx_{i}}{\\pi(\\bx_{i}, \\btheta)} - \\sum_{i \\in S_{B}}d_{i}^{B}\\exp(\\bx_{i}^{T}\\btheta)\\bx_{i}\n\\end{array}\\right) = \\bZero\n\\end{equation*}\n\\] for which derivative along \\(\\boldsymbol{\\eta}\\) is\n\\[\n\\begin{equation*}\n\\phi_n(\\boldsymbol{\\eta})=\\frac{1}{N}\\left(\\begin{array}{cc}\n-\\sum_{i=1}^N\\left\\{\\left(1-\\frac{\\Delta}{\\mu}\\right) \\frac{R_i}{\\pi_i^A}+\\frac{\\Delta}{\\mu}\\right\\} & \\sum_{i=1}^N \\frac{R_i\\left(y_i-\\mu + \\Delta\\right)\\left(1 - \\pi_i^A\\right)\\log \\left(1 - \\pi_i^A\\right)}{\\left(\\pi_i^A\\right)^2} \\boldsymbol{x}_i^{\\top} \\\\\n\\mathbf{0} & \\operatorname{H}(\\btheta)\n\\end{array}\\right),\n\\end{equation*}\n\\] where \\(\\operatorname{H}\\) is hessian in point \\(\\btheta\\). We can show that \\[\n\\begin{equation*}\n\\left[E(\\phi_n(\\boldsymbol{\\eta}))\\right]^{-1}=\\left(\\begin{array}{cc}\n-1 & \\mathbf{b}^T \\\\\n\\mathbf{0} & \\left[\\frac{1}{N}\\operatorname{E}\\left(\\operatorname{H}(\\btheta)\\right)\\right]^{-1}\n\\end{array}\\right),\n\\end{equation*}\n\\] where \\[\n\\mathbf{b}^{\\top} = \\sum_{i=1}^N \\frac{1-\\pi_i^A}{\\pi_i^A} \\log \\left(1 - \\pi_i^A\\right) \\left(y_i - \\mu_y + \\Delta\\right) \\bx_i^{\\top}\\left[\\operatorname{E}\\left(\\operatorname{H} (\\btheta)\\right)\\right]^{-1}.\n\\] Decomposition for this model has following form\n\\[\n\\begin{equation*}\n    \\operatorname{\\bA_1} = \\frac{1}{N} \\sum_{i=1}^N\n    \\left(\\begin{array}{c}\n        \\frac{R_i\\left(y_i - \\mu\\right)}{\\pi_i^A} + \\Delta\\frac{R_i - \\pi_i^A}{\\pi_i^A}  \\\\\n       \\pi_i^A \\frac{\\log\\left(1 - \\pi_i^A\\right)}{\\pi_i^A} \\bx_i -  R_i \\frac{\\log\\left(1 - \\pi_i^A\\right)}{\\pi_i^A} \\bx_i\n    \\end{array}\\right)\n\\end{equation*}\n\\] and \\[\n\\begin{equation*}\n    \\operatorname{\\bA_2} = \\frac{1}{N}\n    \\left(\\begin{array}{c}\n        0  \\\\\n        \\sum_{i \\in \\mathcal{S}_B} d_i^B \\log \\left(1 - \\pi_i^A\\right) \\bx_i - \\sum_{i=1}^N \\pi_i^A  \\frac{\\log \\left(1 - \\pi_i^A\\right)}{\\pi_i^A} \\bx_i\n    \\end{array}\\right)\n\\end{equation*}\n\\] and respectively \\[\n\\begin{equation*}\n\\operatorname{Var}\\left(\\bA_1\\right) = \\frac{1}{N^2} \\sum_{i=1}^N\n\\left(\\begin{array}{cc}\n    \\left(y_i - \\mu + \\Delta\\right)^2 \\left((\\pi_i^A)^{-1} - 1\\right)  & - \\frac{\\left(1 - \\pi_i^A\\right)}{\\pi_i^A} \\log\\left(1 - \\pi_i^A\\right)\\left(y_i - \\mu + \\Delta\\right)\\bx_i^{\\top}  \\\\\n    - \\frac{\\left(1 - \\pi_i^A\\right)}{\\pi_i^A} \\log\\left(1 - \\pi_i^A\\right)\\left(y_i - \\mu + \\Delta\\right)\\bx_i\n    & \\frac{\\left(1 - \\pi_i^A\\right) \\log^2\\left(1 - \\pi_i^A\\right)}{\\pi_i^A} \\bx_i \\bx_i^{\\top}\n\\end{array}\\right)\n\\end{equation*}\n\\] \\[\n\\begin{equation*}\n\\operatorname{Var}\\left(\\bA_2\\right) =\n\\left(\\begin{array}{cc}\n     0 & \\boldsymbol{0}^{\\top} \\\\\n     \\boldsymbol{0} & \\bD\n\\end{array}\\right),\n\\end{equation*}\n\\] where \\[\n\\begin{align}\n    \\bD = \\frac{1}{N^2}V_p\\left(\\sum_{i \\in \\mathcal{S}_B} d_i^B \\log \\left(1 - \\pi_i^A\\right) \\bx_i\\right)\n\\end{align}\n\\] is variance-covariance matrix for sampling design for \\(S_B\\) and can be estimated as …\n\n\nA.1.2 MLE (probit model)\nFrom the model for probit regression we have following system to solve \\[\n\\begin{equation}\n\\boldsymbol{\\Phi}_n(\\boldsymbol{\\eta})=\\left(\\begin{array}{c}\n\\frac{1}{N} \\sum_{i=1}^N\\left[\\frac{R_i\\left(y_i-\\mu\\right)}{\\pi_i^A}+\\Delta \\frac{R_i-\\pi_i^A}{\\pi_i^A}\\right] \\\\\n\\frac{1}{N} \\sum_{i=1}^N R_i \\frac{\\dot{\\pi}_i^A}{\\pi_i^A\\left(1 - \\pi_{i}^A\\right)} \\boldsymbol{x}_i-\\frac{1}{N} \\sum_{i \\in \\mathcal{S}_B} d_i^B \\frac{\\dot{\\pi}_i^A}{1 - \\pi_i^A} \\boldsymbol{x}_i\n\\end{array}\\right)=\\mathbf{0},\n\\end{equation}\n\\] AS before we have to derive \\(\\boldsymbol{\\phi}_n(\\boldsymbol{\\eta})=\\partial \\boldsymbol{\\Phi}_n(\\boldsymbol{\\eta}) / \\partial \\boldsymbol{\\eta}\\) and find decomposition of \\(\\boldsymbol{\\phi}_n(\\boldsymbol{\\eta})\\) and its variance-covariance matrices. Thus, we have \\[\n\\begin{equation*}\n\\phi_n(\\boldsymbol{\\eta})=\\frac{1}{N}\\left(\\begin{array}{cc}\n-\\sum_{i=1}^N\\left\\{\\left(1-\\frac{\\Delta}{\\mu}\\right) \\frac{R_i}{\\pi_i^A}+\\frac{\\Delta}{\\mu}\\right\\} & -\\sum_{i=1}^N \\frac{R_i\\left(y_i-\\mu + \\frac{\\Delta}{\\mu}\\right)\\dot{\\pi}_i^A}{\\left(\\pi_i^A\\right)^2} \\boldsymbol{x}_i^{\\top} \\\\\n\\mathbf{0} & \\operatorname{H}(\\btheta)\n\\end{array}\\right).\n\\end{equation*}\n\\] where \\(\\operatorname{H}\\) is hessian corresponding to set of parameters \\(\\btheta\\). We can show that \\[\n\\begin{equation*}\n\\left[E(\\phi_n(\\boldsymbol{\\eta}))\\right]^{-1}=\\left(\\begin{array}{cc}\n-1 & \\mathbf{b}^T\\\\\n\\mathbf{0} & \\left[\\frac{1}{N}\\operatorname{E}\\left(\\operatorname{H}(\\btheta)\\right)\\right]^{-1}\n\\end{array}\\right),\n\\end{equation*}\n\\] where \\[\n\\mathbf{b}^T = - \\sum_{i=1}^N \\frac{\\left(y_i-\\mu + \\frac{\\Delta}{\\mu}\\right)\\dot{\\pi}_i^A}{\\pi_i^A}\\boldsymbol{x}_i^{\\top}\\left[\\operatorname{E}\\left(\\operatorname{H}(\\btheta)\\right)\\right]^{-1}\n\\] and by the decomposition of \\(\\Phi_n(\\boldsymbol{\\eta})\\) we get \\[\n\\begin{equation*}\n    \\operatorname{\\bA_1} = \\frac{1}{N} \\sum_{i=1}^N\n    \\left(\\begin{array}{c}\n        \\frac{R_i\\left(y_i - \\mu\\right)}{\\pi_i^A} + \\Delta\\frac{R_i - \\pi_i^A}{\\pi_i^A}  \\\\\n         R_i\\frac{\\dot{\\pi}_i^A}{\\pi_i^A\\left(1 - \\pi_i^A\\right)} \\bx_i - \\pi_i^A \\frac{\\dot{\\pi_i^A}}{\\pi_i^A \\left(1 - \\pi_i^A\\right)} \\bx_i\n    \\end{array}\\right)\n\\end{equation*}\n\\] and \\[\n\\begin{equation*}\n    \\operatorname{\\bA_2} = \\frac{1}{N}\n    \\left(\\begin{array}{c}\n        0  \\\\\n        \\sum_{i=1}^N \\pi_i^A \\frac{\\dot{\\pi_i^A}}{\\pi_i^A\\left(1 - \\pi_i^A\\right)} - \\sum_{i \\in S_B} d_i^B\\frac{\\dot{\\pi}_i^A}{1 - \\pi_i^A} \\bx_i\n    \\end{array}\\right)\n\\end{equation*}\n\\] with following variance-covariance matrices \\[\n\\begin{equation*}\n\\operatorname{Var}\\left(\\bA_1\\right) = \\frac{1}{N^2} \\sum_{i=1}^N\n\\left(\\begin{array}{cc}\n     \\left(y_i - \\mu + \\Delta\\right)^2 \\left((\\pi_i^A)^{-1} - 1\\right) &     \\frac{\\dot{\\pi}_i^A\\left(y_i - \\mu + \\Delta\\right)}{\\pi_i^A}\\bx_{i}^{\\top}  \\\\\n    \\frac{\\dot{\\pi}_i^A\\left(y_i - \\mu + \\Delta\\right)}{\\pi_i^A}\\bx_{i} & \\frac{\\dot{\\pi}_i^A}{\\pi_i^A\\left(1 - \\pi_i^A\\right)}\\bx_i\\bx_i^{\\top}\n\\end{array}\\right)\n\\end{equation*}\n\\] and \\[\n\\begin{equation*}\n\\operatorname{Var}\\left(\\bA_2\\right) =\n\\left(\\begin{array}{cc}\n     0 & \\boldsymbol{0}^{\\top} \\\\\n     \\boldsymbol{0} & \\bD\n\\end{array}\\right),\n\\end{equation*}\n\\] where \\[\n\\begin{align}\n    \\bD = \\frac{1}{N^2}V_p\\left(\\sum_{i \\in S_B} d_i^B \\frac{\\dot{\\pi}_i^A}{1 - \\pi_i^A}\\bx_i\\right)\n\\end{align}\n\\] is variance covariance matrix corresponding to probability sample.\n\n\nA.1.3 GEE\nFor generalized estimating equations we have following system of equations to consider \\[\n\\begin{equation}\n\\boldsymbol{\\Phi}_n(\\boldsymbol{\\eta})=\\left(\\begin{array}{c}\n\\frac{1}{N} \\sum_{i=1}^N\\left[\\frac{R_i\\left(y_i-\\mu\\right)}{\\pi_i^A}+\\Delta \\frac{R_i-\\pi_i^A}{\\pi_i^A}\\right] \\\\\n\\frac{1}{N} \\sum_{i=1}^N R_i \\operatorname{h}\\left(\\bx_i\\right)-\\frac{1}{N} \\sum_{i \\in \\mathcal{S}_B} d_i^B \\pi_i^A \\operatorname{h}\\left(\\bx_i\\right)\n\\end{array}\\right)=\\mathbf{0}\n\\end{equation}\n\\] We have following decomposition of \\(\\boldsymbol{\\Phi}_n(\\boldsymbol{\\eta})\\) for this approach \\[\n\\begin{equation}\n\\mathbf{A}_1=\\frac{1}{N} \\sum_{i=1}^N\\left(\\begin{array}{c}\n\\frac{R_i\\left(y_i-\\mu\\right)}{\\pi_i^A}+\\Delta \\frac{R_i-\\pi_i^A}{\\pi_i^A} \\\\\nR_i \\operatorname{h}\\left(\\bx_i\\right)\n\\end{array}\\right), \\quad \\mathbf{A}_2=\\frac{1}{N}\\left(\\begin{array}{c}\n0 \\\\\n- \\sum_{i \\in S_B} d_i^B \\pi_i^A \\operatorname{h}\\left(\\bx_i\\right)\n\\end{array}\\right)\n\\end{equation}\n\\] It can be shown that\n1. for \\(\\operatorname{h}\\left(\\bx_i\\right) = \\bx_i\\)\n\\[\n\\mathbf{V}_1=\\frac{1}{N^2} \\sum_{i=1}^N\\left(\\begin{array}{cc}\n\\left\\{\\left(1-\\pi_i^A\\right) / \\pi_i^A\\right\\}\\left(y_i-\\mu+\\Delta\\right)^2 & \\left(1-\\pi_i^A\\right)\\left(y_i-\\mu+\\Delta\\right) \\boldsymbol{x}_i^{\\top} \\\\\n\\left(1-\\pi_i^A\\right)\\left(y_i-\\mu+\\Delta\\right) \\boldsymbol{x}_i & \\pi_i^A\\left(1-\\pi_i^A\\right) \\boldsymbol{x}_i \\boldsymbol{x}_i^{\\top}\n\\end{array}\\right)\n\\] and \\[\n\\mathbf{V}_2=\\left(\\begin{array}{cc}\n0 & \\mathbf{0}^{\\top} \\\\\n\\mathbf{0} & \\mathbf{D}\n\\end{array}\\right)\n\\] where \\[\\mathbf{D}=N^{-2} V_p\\left(\\sum_{i \\in \\mathcal{S}_B} d_i^B \\pi_i^A \\boldsymbol{x}_i\\right)\\]\n2. for \\(\\operatorname{h}\\left(\\bx_i\\right) = \\bx_i \\pi_i^A(\\bx_i, \\btheta) ^{-1}\\) \\[\n\\mathbf{V}_1=\\frac{1}{N^2} \\sum_{i=1}^N\\left(\\begin{array}{cc}\n\\left\\{\\left(1-\\pi_i^A\\right) / \\pi_i^A\\right\\}\\left(y_i-\\mu+\\Delta\\right)^2 & \\frac{\\left(1-\\pi_i^A\\right)}{\\pi_i^A}\\left(y_i-\\mu+\\Delta\\right) \\boldsymbol{x}_i^{\\top} \\\\\n\\frac{\\left(1-\\pi_i^A\\right)}{\\pi_i^A}\\left(y_i-\\mu+\\Delta\\right) \\boldsymbol{x}_i & \\left(1-\\pi_i^A\\right) \\boldsymbol{x}_i \\boldsymbol{x}_i^{\\top}\n\\end{array}\\right)\n\\] and \\[\n\\mathbf{V}_2=\\left(\\begin{array}{cc}\n0 & \\mathbf{0}^{\\top} \\\\\n\\mathbf{0} & \\mathbf{D}\n\\end{array}\\right)\n\\] where \\[\\mathbf{D}=N^{-2} V_p\\left(\\sum_{i \\in \\mathcal{S}_B} d_i^B \\boldsymbol{x}_i\\right).\\] To determine the variance-covariance matrix for \\(\\hat{\\boldsymbol{\\eta}}\\) we need to derive \\(\\boldsymbol{\\phi}_n(\\boldsymbol{\\eta})=\\partial \\boldsymbol{\\Phi}_n(\\boldsymbol{\\eta}) / \\partial \\boldsymbol{\\eta}\\) which depends on the choosen \\(h\\)-function and model for propensity score."
  },
  {
    "objectID": "appendix.html#dr-estimator-variance",
    "href": "appendix.html#dr-estimator-variance",
    "title": "Appendix A — Appendices",
    "section": "A.2 DR estimator variance",
    "text": "A.2 DR estimator variance\nIn this subsection we show how to derive variance for doubly robust estimator under probit and cloglog models for propensity score and General estimating equations as well. The derivation in analogous to that of the section on doubly robust methods for non-probability sample. The technical difference lies in the imputation of another modeling function for propensity score.\n\nA.2.1 MLE with cloglog and probit models\nUsing the equation (2.1) on \\(\\mu_{IPW2}\\) for the probit model we have \\[\n\\begin{equation}\n\\begin{aligned}\n\\frac{1}{\\hat{N}^A} \\sum_{i=1}^N \\frac{R_i\\left\\{y_i-m\\left(\\boldsymbol{x}_i, \\boldsymbol{\\beta}^*\\right)\\right\\}}{\\hat{\\pi}_i^A} = & h_N+\\frac{1}{N} \\sum_{i=1}^N R_i\\left\\{\\frac{y_i-m\\left(\\boldsymbol{x}_i, \\boldsymbol{\\beta}^*\\right)-h_N}{\\pi_i^A}-\\mathbf{b}^{\\top} \\frac{\\dot{\\pi}_i^A}{\\pi_i^A \\left(1 - \\pi_i^A\\right)} \\boldsymbol{x}_i\\right\\} \\\\\n& +\\mathbf{b}_3^{\\top} \\frac{1}{N} \\sum_{i \\in \\mathcal{S}_B} d_i^B \\frac{\\dot{\\pi}_i^A}{\\left(1 - \\pi_i^A\\right)} \\boldsymbol{x}_i+o_p\\left(n_A^{-1 / 2}\\right),\n\\end{aligned}\n\\end{equation}\n\\] where \\(h_n = \\frac{1}{N} \\sum_{i=1}^N \\left(y_i - \\operatorname{m}\\left(\\bx_i,\\bbeta^*\\right)\\right)\\) and \\[\n\\mathbf{b}^{\\top} = -\\sum_{i=1}^N \\frac{\\left(y_i - \\operatorname{m}\\left(\\bx_i,\\bbeta^*\\right) - h_n\\right)\\dot{\\pi}_i^A}{\\pi_i^A}\\boldsymbol{x}_i^{\\top}\\left[\\operatorname{E}\\left(\\operatorname{H}(\\btheta)\\right)\\right]^{-1}.\n\\] The second part of the estimator has the following expansion \\[\n\\begin{equation} \\label{eq2}\n\\frac{1}{\\hat{N}^B} \\sum_{i \\in \\mathcal{S}_B} d_i^B m\\left(\\bx_i,\\bbeta^*\\right)=\\frac{1}{N} \\sum_{i=1}^N m\\left(\\bx_i,\\bbeta^*\\right)+\\frac{1}{N} \\sum_{i \\in \\mathcal{S}_B} d_i^B\\left\\{m\\left(\\bx_i,\\bbeta^*\\right)-\\frac{1}{N} \\sum_{i=1}^N m\\left(\\bx_i,\\bbeta^*\\right)\\right\\}+O_p\\left(n_B^{-1}\\right)\n\\end{equation}\n\\] Putting these two parts together implies: \\[\n\\begin{equation}\n\\begin{aligned}\n\\hat{\\mu}_{D R 2}-\\mu_y = & \\frac{1}{N} \\sum_{i=1}^N R_i\\left\\{\\frac{y_i-m\\left(\\boldsymbol{x}_i, \\boldsymbol{\\beta}^*\\right)-h_N}{\\pi_i^A}-\\mathbf{b}_3^{\\top} \\frac{\\dot{\\pi}_i^A}{\\pi_i^A \\left(1 - \\pi_i^A \\right)} \\boldsymbol{x}_i\\right\\} \\\\\n& +\\frac{1}{N} \\sum_{i \\in \\mathcal{S}_B} d_i^B t_i +o_p\\left(n_A^{-1 / 2}\\right)\n\\end{aligned}\n\\end{equation}\n\\] It follows that \\[\n\\begin{equation*}\n    \\begin{aligned}\n        \\text{var}\\left(\\hat{\\mu}_{DR}\\right) = & \\frac{1}{N^2} \\sum_{i=1}^N \\left(1 - \\pi_i^A\\right)\\pi_i^A \\left[\\frac{y_i - \\operatorname{m}\\left(\\bx_i,\\bbeta^*\\right) - h_n}{\\pi_i^A} - \\mathbf{b}_3^T\\frac{\\dot{\\pi}_i^A}{\\pi_i^A \\left(1 - \\pi_i^A \\right)}\\bx_i\\right]^2 \\\\ & + \\operatorname{W} + o(n_A^{-1}),\n    \\end{aligned}\n\\end{equation*}\n\\] where \\[\n\\begin{align}\n    \\operatorname{W} = \\frac{1}{N^2}\\text{var}_p\\left(\\sum_{i \\in S_B} d_i^B t_i\\right)\n\\end{align}\n\\] and \\(t_i = \\frac{\\dot{\\pi}_i^A}{1 - \\pi_i^A} \\bx_i^{\\top} \\mathbf{b}_3 + \\operatorname{m}\\left(\\bx_i,\\bbeta^*\\right)- \\frac{1}{N} \\sum_{i=1}^N \\operatorname{m}\\left(\\bx_i,\\bbeta^*\\right)\\).\nWhen propensity scores are estimating by complementary log-log model, the results are as follows \\[\n\\begin{equation}\n\\begin{aligned}\n\\frac{1}{\\hat{N}^A} \\sum_{i=1}^N \\frac{R_i\\left\\{y_i-m\\left(\\boldsymbol{x}_i, \\boldsymbol{\\beta}^*\\right)\\right\\}}{\\hat{\\pi}_i^A} = & h_N+\\frac{1}{N} \\sum_{i=1}^N R_i\\left\\{\\frac{y_i-m\\left(\\boldsymbol{x}_i, \\boldsymbol{\\beta}^*\\right)-h_N}{\\pi_i^A}-\\mathbf{b}^{\\top} \\frac{\\log \\left(1 - \\pi_i^A\\right)}{\\pi_i^A} \\boldsymbol{x}_i\\right\\} \\\\\n& +\\mathbf{b}_3^{\\top} \\frac{1}{N} \\sum_{i \\in \\mathcal{S}_B} d_i^B \\log \\left(1 - \\pi_i^A\\right) \\boldsymbol{x}_i+o_p\\left(n_A^{-1 / 2}\\right),\n\\end{aligned}\n\\end{equation}\n\\] where \\[\\mathbf{b}^{\\top} = -\\sum_{i=1}^N \\frac{\\left(y_i - \\operatorname{m}\\left(\\bx_i,\\bbeta^*\\right) - h_n\\right)\\left(1 - \\pi_i^A\\right) \\log \\left(1 - \\pi_i^A\\right)}{\\pi_i^A}\\boldsymbol{x}_i^{\\top}\\left[\\operatorname{E}\\left(\\operatorname{H}_{l}(\\btheta)\\right)\\right]^{-1}.\\] The second part of the \\(\\hat{\\mu}_{DR}\\) is expanded as in (2.6) \\[\n\\begin{equation}\n\\begin{aligned}\n\\hat{\\mu}_{D R 2}-\\mu_y = & \\frac{1}{N} \\sum_{i=1}^N R_i\\left\\{\\frac{y_i-m\\left(\\boldsymbol{x}_i, \\boldsymbol{\\beta}^*\\right)-h_N}{\\pi_i^A}-\\mathbf{b}_3^{\\top} \\frac{\\log \\left(1 - \\pi_i^A\\right)}{\\pi_i^A} \\boldsymbol{x}_i\\right\\} \\\\\n& +\\frac{1}{N} \\sum_{i \\in \\mathcal{S}_B} d_i^B t_i +o_p\\left(n_A^{-1 / 2}\\right),\n\\end{aligned}\n\\end{equation}\n\\] what implies that \\[\n\\begin{equation*}\n    \\begin{aligned}\n        \\operatorname{Var}\\left(\\hat{\\mu}_{DR}\\right) = & \\frac{1}{N^2} \\sum_{i=1}^N \\left(1 - \\pi_i^A\\right)\\pi_i^A \\left[\\frac{y_i - \\operatorname{m}\\left(\\bx_i,\\bbeta^*\\right) - h_n}{\\pi_i^A} - \\mathbf{b}_3^T \\frac{\\log\\left(1 - \\pi_i^A\\right)}{\\pi_i^A}\\bx_i\\right]^2 \\\\ & +\n        \\operatorname{W} + o(n_A^{-1}),\n    \\end{aligned}\n\\end{equation*}\n\\] where \\[\n\\begin{align}\n    \\operatorname{W} = \\frac{1}{N^2}\\text{var}_p\\left(\\sum_{i \\in S_B} d_i^B t_i\\right)\n\\end{align}\n\\] and \\(t_i = \\log \\left(1 - \\pi_i^A \\right) \\bx_i^{\\top} \\mathbf{b}_3 + \\operatorname{m}\\left(\\bx_i,\\bbeta^*\\right)- \\frac{1}{N} \\sum_{i=1}^N \\operatorname{m}\\left(\\bx_i,\\bbeta^*\\right)\\).\n\n\nA.2.2 GEE\nAs with MLE, we will use Taylor expansion to derive the variance for the DR of the estimator. For \\(\\operatorname{h}\\left(\\bx_i\\right) = \\bx_i\\) we have \\[\n\\begin{aligned}\n\\frac{1}{\\hat{N}^A} \\sum_{i=1}^N \\frac{R_i\\left\\{y_i-m\\left(\\boldsymbol{x}_i, \\boldsymbol{\\beta}^*\\right)\\right\\}}{\\hat{\\pi}_i^A}= & h_N+\\frac{1}{N} \\sum_{i=1}^N R_i\\left\\{\\frac{y_i-m\\left(\\boldsymbol{x}_i, \\boldsymbol{\\beta}^*\\right)-h_N}{\\pi_i^A}-\\mathbf{b}^{\\top} \\boldsymbol{x}_i\\right\\} \\\\\n& +\\mathbf{b}^{\\top} \\frac{1}{N} \\sum_{i \\in \\mathcal{S}_B} d_i^B \\pi_i^A \\boldsymbol{x}_i+o_p\\left(n_A^{-1 / 2}\\right)\n\\end{aligned}\n\\] where \\(h_N=N^{-1} \\sum_{i=1}^N\\left\\{y_i-m\\left(\\boldsymbol{x}_i, \\boldsymbol{\\beta}^*\\right)\\right\\}\\).\nThe second part of \\(\\hat{\\mu}_{D R 2}\\) given in is the Hájek estimator under the probability sampling design for \\(\\mathcal{S}_B\\), which has the following expansion \\[\n\\frac{1}{\\hat{N}^B} \\sum_{i \\in \\mathcal{S}_B} d_i^B m_i=\\frac{1}{N} \\sum_{i=1}^N m_i+\\frac{1}{N} \\sum_{i \\in \\mathcal{S}_B} d_i^B\\left\\{m_i-\\frac{1}{N} \\sum_{i=1}^N m_i\\right\\}+O_p\\left(n_B^{-1}\\right)\n\\], where \\(m_i=m\\left(\\boldsymbol{x}_i, \\boldsymbol{\\beta}^*\\right)\\). Putting these two parts together we have \\[\n\\hat{\\mu}_{D R 2}-\\mu_y=\\frac{1}{N} \\sum_{i=1}^N R_i\\left\\{\\frac{y_i-m\\left(\\boldsymbol{x}_i, \\boldsymbol{\\beta}^*\\right)-h_N}{\\pi_i^A}-\\mathbf{b}^{\\top} \\boldsymbol{x}_i\\right\\}+\\frac{1}{N} \\sum_{i \\in \\mathcal{S}_B} d_i^B t_i+o_p\\left(n_A^{-1 / 2}\\right)\n\\] where \\(t_i=\\pi_i^A \\boldsymbol{x}_i^{\\top} \\mathbf{b}_3+m\\left(\\boldsymbol{x}_i, \\boldsymbol{\\beta}^*\\right)-N^{-1} \\sum_{i=1}^N m\\left(\\boldsymbol{x}_i, \\boldsymbol{\\beta}^*\\right)\\) and it follows that \\[\n\\begin{gathered}\n\\text{var}_{\\mathrm{DR} 2}=\\frac{1}{N^2} \\sum_{i=1}^N\\left(1-\\pi_i^{\\mathrm{A}}\\right) \\pi_i^{\\mathrm{A}}\\left[\\left\\{\\frac{y_i-m\\left(\\boldsymbol{x}_i, \\boldsymbol{\\beta}^*\\right)-h_{\\mathrm{N}}}{\\pi_i^A}\\right\\} -\n\\mathbf{b}^{\\top} \\boldsymbol{x}_i\\right]^2 + N^{-2} V_p\\left(\\sum_{i \\in \\mathcal{S}_{\\mathrm{B}}} d_i^{\\mathrm{B}} t_i\\right)\n\\end{gathered}\n\\]\nBy analogy, it can be shown that for \\(\\operatorname{h}\\left(\\bx_i\\right) = \\bx_i \\pi_i^A\\left(\\bx_i^{\\mathrm{T}} \\btheta \\right)^{-1}\\) we have \\[\n\\begin{gathered}\n\\text{var}_{\\mathrm{DR} 2}=\\frac{1}{N^2} \\sum_{i=1}^N\\left(1-\\pi_i^{\\mathrm{A}}\\right) \\pi_i^{\\mathrm{A}}\\left[\\left\\{\\frac{y_i-m\\left(\\boldsymbol{x}_i, \\boldsymbol{\\beta}^*\\right)-h_{\\mathrm{N}}}{\\pi_i^A}\\right\\} -\n\\frac{\\mathbf{b}_3^{\\top} \\boldsymbol{x}_i}{\\pi_i^A}\\right]^2 + N^{-2} V_p\\left(\\sum_{i \\in \\mathcal{S}_{\\mathrm{B}}} d_i^{\\mathrm{B}} t_i\\right)\n\\end{gathered}\n\\] where \\(t_i= \\boldsymbol{x}_i^{\\top} \\mathbf{b}_3+m\\left(\\boldsymbol{x}_i, \\boldsymbol{\\beta}^*\\right)-N^{-1} \\sum_{i=1}^N m\\left(\\boldsymbol{x}_i, \\boldsymbol{\\beta}^*\\right)\\) and independently of the function of \\(\\operatorname{h}\\)\n1. for logit model\n\\[\n\\mathbf{b}^{\\top}=\\left[\\frac{1}{N} \\sum_{i=1}^N\\left(1-\\pi_i^A\\right)\\left\\{y_i-m\\left(\\boldsymbol{x}_i, \\boldsymbol{\\beta}^*\\right)-h_N\\right\\} \\boldsymbol{x}_i^{\\top}\\right]\\left\\{\\frac{1}{N} \\sum_{i=1}^N \\pi_i^A\\left(1-\\pi_i^A\\right) \\boldsymbol{x}_i \\boldsymbol{x}_i^{\\top}\\right\\}^{-1}\n\\]\n2. for complementary loglog model\n\\[\\mathbf{b}^{\\top} = -\\sum_{i=1}^N \\frac{\\left(y_i - \\operatorname{m}\\left(\\bx_i,\\bbeta^*\\right) - h_n\\right)\\left(1 - \\pi_i^A\\right) \\log \\left(1 - \\pi_i^A\\right)}{\\pi_i^A}\\boldsymbol{x}_i^{\\top} \\left\\{\\frac{1}{N}\\sum_{i=1}^N \\left(1 - \\pi_i^A\\right) \\exp\\left(\\bx_i^{\\top}\\btheta\\right) \\bx_i \\bx_i^{\\top}\\right\\} ^ {-1}\\]\n3. for probit model\n\\[\\mathbf{b}^{\\top} = -\\sum_{i=1}^N \\frac{\\left(y_i - \\operatorname{m}\\left(\\bx_i,\\bbeta^*\\right) - h_n\\right)\\dot{\\pi}_i^A}{\\pi_i^A}\\boldsymbol{x}_i^{\\top} \\left\\{\\frac{1}{N}\\sum_{i=1}^N \\pi_i^A \\bx_i \\bx_i^{\\top}\\right\\} ^ {-1}\\]"
  },
  {
    "objectID": "summary.html",
    "href": "summary.html",
    "title": "7  Summary",
    "section": "",
    "text": "\\[\n\\newcommand{\\bSigma}{\\boldsymbol{\\Sigma}}\n\\newcommand{\\bOmega}{\\boldsymbol{\\Omega}}\n\\newcommand{\\bTheta}{\\boldsymbol{\\Theta}}\n\\newcommand{\\bPi}{\\boldsymbol{\\Pi}}\n\\newcommand{\\bbeta}{\\boldsymbol{\\beta}}\n\\newcommand{\\balpha}{\\boldsymbol{\\alpha}}\n\\newcommand{\\brho}{\\boldsymbol{\\rho}}\n\\newcommand{\\beps}{\\boldsymbol{\\epsilon}}\n\\newcommand{\\blambda}{\\boldsymbol{\\lambda}}\n\\newcommand{\\bgamma}{\\boldsymbol{\\gamma}}\n\\newcommand{\\btheta}{\\boldsymbol{\\theta}}\n\\newcommand{\\bmu}{\\boldsymbol{\\mu}}\n\\newcommand{\\bpi}{\\boldsymbol{\\pi}}\n\\newcommand{\\bphi}{\\boldsymbol{\\phi}}\n\\newcommand{\\bPhi}{\\boldsymbol{\\Phi}}\n\\newcommand{\\boldeta}{\\boldsymbol{\\eta}}\n\\newcommand{\\bx}{\\boldsymbol{x}}\n\\newcommand{\\bD}{\\boldsymbol{D}}\n\\newcommand{\\bV}{\\boldsymbol{V}}\n\\newcommand{\\bv}{\\boldsymbol{v}}\n\\newcommand{\\bY}{\\boldsymbol{Y}}\n\\newcommand{\\bA}{\\boldsymbol{A}}\n\\newcommand{\\bB}{\\boldsymbol{B}}\n\\newcommand{\\bR}{\\boldsymbol{R}}\n\\newcommand{\\bM}{\\boldsymbol{M}}\n\\newcommand{\\bI}{\\boldsymbol{I}}\n\\newcommand{\\bC}{\\boldsymbol{C}}\n\\newcommand{\\bW}{\\boldsymbol{W}}\n\\newcommand{\\bw}{\\boldsymbol{w}}\n\\newcommand{\\bd}{\\boldsymbol{d}}\n\\newcommand{\\bT}{\\boldsymbol{T}}\n\\newcommand{\\bt}{\\boldsymbol{t}}\n\\newcommand{\\bZ}{\\boldsymbol{Z}}\n\\newcommand{\\bX}{\\boldsymbol{X}}\n\\newcommand{\\bz}{\\boldsymbol{z}}\n\\newcommand{\\by}{\\boldsymbol{y}}\n\\newcommand{\\br}{\\boldsymbol{r}}\n\\newcommand{\\bp}{\\boldsymbol{p}}\n\\newcommand{\\bb}{\\boldsymbol{b}}\n\\newcommand{\\bZero}{\\boldsymbol{0}}\n\\newcommand{\\bOne}{\\boldsymbol{1}}\n\\]"
  },
  {
    "objectID": "variableselection.html",
    "href": "variableselection.html",
    "title": "6  Techniques of variables selection for high-dimensional data",
    "section": "",
    "text": "\\[\n\\newcommand{\\bSigma}{\\boldsymbol{\\Sigma}}\n\\newcommand{\\bOmega}{\\boldsymbol{\\Omega}}\n\\newcommand{\\bTheta}{\\boldsymbol{\\Theta}}\n\\newcommand{\\bPi}{\\boldsymbol{\\Pi}}\n\\newcommand{\\bbeta}{\\boldsymbol{\\beta}}\n\\newcommand{\\balpha}{\\boldsymbol{\\alpha}}\n\\newcommand{\\brho}{\\boldsymbol{\\rho}}\n\\newcommand{\\beps}{\\boldsymbol{\\epsilon}}\n\\newcommand{\\blambda}{\\boldsymbol{\\lambda}}\n\\newcommand{\\bgamma}{\\boldsymbol{\\gamma}}\n\\newcommand{\\btheta}{\\boldsymbol{\\theta}}\n\\newcommand{\\bmu}{\\boldsymbol{\\mu}}\n\\newcommand{\\bpi}{\\boldsymbol{\\pi}}\n\\newcommand{\\bphi}{\\boldsymbol{\\phi}}\n\\newcommand{\\bPhi}{\\boldsymbol{\\Phi}}\n\\newcommand{\\boldeta}{\\boldsymbol{\\eta}}\n\\newcommand{\\bx}{\\boldsymbol{x}}\n\\newcommand{\\bD}{\\boldsymbol{D}}\n\\newcommand{\\bV}{\\boldsymbol{V}}\n\\newcommand{\\bv}{\\boldsymbol{v}}\n\\newcommand{\\bY}{\\boldsymbol{Y}}\n\\newcommand{\\bA}{\\boldsymbol{A}}\n\\newcommand{\\bB}{\\boldsymbol{B}}\n\\newcommand{\\bR}{\\boldsymbol{R}}\n\\newcommand{\\bM}{\\boldsymbol{M}}\n\\newcommand{\\bI}{\\boldsymbol{I}}\n\\newcommand{\\bC}{\\boldsymbol{C}}\n\\newcommand{\\bW}{\\boldsymbol{W}}\n\\newcommand{\\bw}{\\boldsymbol{w}}\n\\newcommand{\\bd}{\\boldsymbol{d}}\n\\newcommand{\\bT}{\\boldsymbol{T}}\n\\newcommand{\\bt}{\\boldsymbol{t}}\n\\newcommand{\\bZ}{\\boldsymbol{Z}}\n\\newcommand{\\bX}{\\boldsymbol{X}}\n\\newcommand{\\bz}{\\boldsymbol{z}}\n\\newcommand{\\by}{\\boldsymbol{y}}\n\\newcommand{\\br}{\\boldsymbol{r}}\n\\newcommand{\\bp}{\\boldsymbol{p}}\n\\newcommand{\\bb}{\\boldsymbol{b}}\n\\newcommand{\\bZero}{\\boldsymbol{0}}\n\\newcommand{\\bOne}{\\boldsymbol{1}}\n\\]"
  },
  {
    "objectID": "variableselection.html#lasso",
    "href": "variableselection.html#lasso",
    "title": "6  Techniques of variables selection for high-dimensional data",
    "section": "6.1 LASSO",
    "text": "6.1 LASSO\n\\[\np_{\\lambda}(x) = \\lambda |x|\n\\] and its derivative\n\\[\np_{\\lambda}(x)= \\begin{cases} - \\lambda & \\text { if }x < 0, \\\\ \\left[-\\lambda, \\lambda\\right] & \\text { if } x = 0 \\\\ \\lambda & \\text { if }x > 0\\end{cases}\n\\]"
  },
  {
    "objectID": "variableselection.html#scad",
    "href": "variableselection.html#scad",
    "title": "6  Techniques of variables selection for high-dimensional data",
    "section": "6.2 SCAD",
    "text": "6.2 SCAD\n\\[\np_{\\lambda}(x ; \\gamma)= \\begin{cases}\\lambda|x| & \\text { if }|x| \\leq \\lambda, \\\\ \\frac{2 \\gamma \\lambda|x|-x^2-\\lambda^2}{2(\\gamma-1)} & \\text { if } \\lambda<|x|<\\gamma \\lambda \\\\ \\frac{\\lambda^2(\\gamma+1)}{2} & \\text { if }|x| \\geq \\gamma \\lambda\\end{cases}\n\\] and derivative is \\[\nq_{\\lambda}(x ;  \\gamma)= \\begin{cases}\\lambda & \\text { if }|x| \\leq \\lambda \\\\ \\frac{\\gamma \\lambda-|x|}{\\gamma-1} & \\text { if } \\lambda<|x|<\\gamma \\lambda \\\\ 0 & \\text { if }|x| \\geq \\gamma \\lambda\\end{cases}\n\\]"
  },
  {
    "objectID": "variableselection.html#mcp",
    "href": "variableselection.html#mcp",
    "title": "6  Techniques of variables selection for high-dimensional data",
    "section": "6.3 MCP",
    "text": "6.3 MCP\n\\[\np_{\\lambda}(x ; \\gamma)= \\begin{cases}\\lambda|x|-\\frac{x^2}{2 \\gamma}, & \\text { if }|x| \\leq \\gamma \\lambda \\\\ \\frac{1}{2} \\gamma \\lambda^2, & \\text { if }|x|>\\gamma \\lambda\\end{cases}\n\\] and derivative is \\[\nq_\\lambda(x ; \\gamma)= \\begin{cases}\\left(\\lambda-\\frac{|x|}{\\gamma}\\right) \\operatorname{sign}(x), & \\text { if }|x| \\leq \\gamma \\lambda, \\\\ 0, & \\text { if }|x|>\\gamma \\lambda\\end{cases}\n\\]"
  },
  {
    "objectID": "variableselection.html#solution",
    "href": "variableselection.html#solution",
    "title": "6  Techniques of variables selection for high-dimensional data",
    "section": "6.3 Solution",
    "text": "6.3 Solution\nBy minorization-maximization algorithm, the penalized estimator \\(\\left(\\hat{\\btheta}, \\hat{\\bbeta}\\right)\\) satisfies\n\\[\n\\operatorname{U}^p\\left(\\hat{\\btheta}, \\hat{\\bbeta}\\right) = \\operatorname{U}\\left(\\hat{\\btheta}, \\hat{\\bbeta}\\right) -\\left(\\begin{array}{c}\nq_{\\lambda_\\hat{\\theta}}(|\\hat{\\btheta}|) \\operatorname{sgn}(\\hat{\\btheta}) \\frac{|\\hat{\\btheta}|}{\\epsilon + |\\hat{\\btheta}|} \\\\\nq_{\\lambda_\\hat{\\beta}}(|\\hat{\\bbeta}|) \\operatorname{sgn}(\\hat{\\bbeta}) \\frac{|\\hat{\\bbeta}|}{\\epsilon + |\\hat{\\bbeta}|}\n\\end{array}\\right) = \\bZero\n\\] Let \\(\\nabla\\left(\\btheta, \\bbeta \\right) = \\frac{\\partial \\operatorname{U}\\left(\\btheta, \\bbeta\\right)}{\\partial \\left(\\btheta^{T} \\bbeta^{T}\\right)^{T}} = Diag \\left(\\frac{\\partial U_1 \\left(\\btheta \\right)}{\\partial \\btheta^{T}}, \\frac{\\partial U_2 \\left(\\bbeta \\right)}{\\partial \\bbeta^{T}} \\right)\\), where \\(U_1\\) is objective function for selection model and \\(U_2\\) for outcome model. Let \\(\\boldsymbol{\\alpha} = \\left(\\btheta, \\bbeta\\right)\\) and\n\\[\n\\Lambda(\\boldsymbol{\\alpha})=\\left(\\begin{array}{ccc}\nq_{\\lambda_1}\\left(\\left|\\alpha_1\\right|\\right) & \\ldots & 0 \\\\\n\\vdots & \\ddots & \\vdots \\\\\n0 & \\ldots & q_{\\lambda_{2 p}}\\left(\\left|\\alpha_{2 p}\\right|\\right)\n\\end{array}\\right)\n\\] Newton-Raphson procedure for j-variable and k-update\n\\[\n\\hat{\\alpha}_j^{[k]}=\\hat{\\alpha}_j^{[k-1]}+\\left\\{\\nabla_{j j}\\left(\\hat{\\alpha}^{[k-1]}\\right)+N \\Lambda_{j j}\\left(\\hat{\\alpha}^{[k-1]}\\right)\\right\\}^{-1}\\left\\{U_j\\left(\\hat{\\alpha}^{[k-1]}\\right)-N \\Lambda_{j j}\\left(\\hat{\\alpha}^{[k-1]}\\right) \\hat{\\alpha}_j^{[k-1]}\\right\\}\n\\]\nIt is recommended to use K-fold cross validation for selectiing tuning parameters \\(\\left(\\lambda_{\\theta}, \\lambda_{\\beta}\\right)\\) which minimize following loss functions for set of parameters \\(\\balpha\\).\n\\[\n\\operatorname{Loss}\\left(\\lambda_\\theta\\right)=\\sum_{j=1}^p\\left(\\sum_{i=1}^N\\left[\\frac{R_i^A}{\\pi_i^A\\left\\{\\bx_i^{\\mathrm{T}} \\hat{\\theta}\\left(\\lambda_\\theta\\right)\\right\\}}-\\frac{I_{\\mathrm{A}, i}}{\\pi_{\\mathrm{A}, i}}\\right] \\bx_{i, j}\\right)^2,\n\\]\n\\[\n\\operatorname{Loss}\\left(\\lambda_\\beta\\right)=\\sum_{i=1}^N R_i^A\\left[y_i-m\\left\\{\\bx_i^{\\mathrm{T}} \\hat{\\beta}\\left(\\lambda_\\beta\\right)\\right\\}\\right]^2,\n\\] where \\(\\hat{\\theta}\\left(\\lambda_\\theta\\right)\\) and \\(\\hat{\\beta}\\left(\\lambda_\\beta\\right)\\) are penalized estimators with tuning parameters \\(\\lambda_\\theta\\), \\(\\lambda_\\beta\\) for selection and outcome model respectively. For estimation we consider only the union of covariates \\(\\bX_C\\), where \\(C = \\hat{M}_{\\theta} + \\hat{M}_{\\beta}\\) and \\(\\hat{M}_{\\theta} = \\left\\{j: \\hat{\\theta}_j \\ne 0\\right\\}\\) and \\(\\hat{M}_{\\beta} = \\left\\{j: \\hat{\\beta}_j \\ne 0\\right\\}\\). In short, we estimate only on truly important variables for selection and outcome models."
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Modern inference methods for non-probability samples with R",
    "section": "",
    "text": "\\[\n\\newcommand{\\bSigma}{\\boldsymbol{\\Sigma}}\n\\newcommand{\\bOmega}{\\boldsymbol{\\Omega}}\n\\newcommand{\\bTheta}{\\boldsymbol{\\Theta}}\n\\newcommand{\\bPi}{\\boldsymbol{\\Pi}}\n\\newcommand{\\bbeta}{\\boldsymbol{\\beta}}\n\\newcommand{\\balpha}{\\boldsymbol{\\alpha}}\n\\newcommand{\\brho}{\\boldsymbol{\\rho}}\n\\newcommand{\\beps}{\\boldsymbol{\\epsilon}}\n\\newcommand{\\blambda}{\\boldsymbol{\\lambda}}\n\\newcommand{\\bgamma}{\\boldsymbol{\\gamma}}\n\\newcommand{\\btheta}{\\boldsymbol{\\theta}}\n\\newcommand{\\bmu}{\\boldsymbol{\\mu}}\n\\newcommand{\\bpi}{\\boldsymbol{\\pi}}\n\\newcommand{\\bphi}{\\boldsymbol{\\phi}}\n\\newcommand{\\bPhi}{\\boldsymbol{\\Phi}}\n\\newcommand{\\boldeta}{\\boldsymbol{\\eta}}\n\\newcommand{\\bx}{\\boldsymbol{x}}\n\\newcommand{\\bD}{\\boldsymbol{D}}\n\\newcommand{\\bV}{\\boldsymbol{V}}\n\\newcommand{\\bv}{\\boldsymbol{v}}\n\\newcommand{\\bY}{\\boldsymbol{Y}}\n\\newcommand{\\bA}{\\boldsymbol{A}}\n\\newcommand{\\bB}{\\boldsymbol{B}}\n\\newcommand{\\bR}{\\boldsymbol{R}}\n\\newcommand{\\bM}{\\boldsymbol{M}}\n\\newcommand{\\bI}{\\boldsymbol{I}}\n\\newcommand{\\bC}{\\boldsymbol{C}}\n\\newcommand{\\bW}{\\boldsymbol{W}}\n\\newcommand{\\bw}{\\boldsymbol{w}}\n\\newcommand{\\bd}{\\boldsymbol{d}}\n\\newcommand{\\bT}{\\boldsymbol{T}}\n\\newcommand{\\bt}{\\boldsymbol{t}}\n\\newcommand{\\bZ}{\\boldsymbol{Z}}\n\\newcommand{\\bX}{\\boldsymbol{X}}\n\\newcommand{\\bz}{\\boldsymbol{z}}\n\\newcommand{\\by}{\\boldsymbol{y}}\n\\newcommand{\\br}{\\boldsymbol{r}}\n\\newcommand{\\bp}{\\boldsymbol{p}}\n\\newcommand{\\bb}{\\boldsymbol{b}}\n\\newcommand{\\bZero}{\\boldsymbol{0}}\n\\newcommand{\\bOne}{\\boldsymbol{1}}\n\\]"
  },
  {
    "objectID": "intro.html",
    "href": "intro.html",
    "title": "2  Introduction and Overview",
    "section": "",
    "text": "\\[\n\\newcommand{\\bSigma}{\\boldsymbol{\\Sigma}}\n\\newcommand{\\bOmega}{\\boldsymbol{\\Omega}}\n\\newcommand{\\bTheta}{\\boldsymbol{\\Theta}}\n\\newcommand{\\bPi}{\\boldsymbol{\\Pi}}\n\\newcommand{\\bbeta}{\\boldsymbol{\\beta}}\n\\newcommand{\\balpha}{\\boldsymbol{\\alpha}}\n\\newcommand{\\brho}{\\boldsymbol{\\rho}}\n\\newcommand{\\beps}{\\boldsymbol{\\epsilon}}\n\\newcommand{\\blambda}{\\boldsymbol{\\lambda}}\n\\newcommand{\\bgamma}{\\boldsymbol{\\gamma}}\n\\newcommand{\\btheta}{\\boldsymbol{\\theta}}\n\\newcommand{\\bmu}{\\boldsymbol{\\mu}}\n\\newcommand{\\bpi}{\\boldsymbol{\\pi}}\n\\newcommand{\\bphi}{\\boldsymbol{\\phi}}\n\\newcommand{\\bPhi}{\\boldsymbol{\\Phi}}\n\\newcommand{\\boldeta}{\\boldsymbol{\\eta}}\n\\newcommand{\\bx}{\\boldsymbol{x}}\n\\newcommand{\\bD}{\\boldsymbol{D}}\n\\newcommand{\\bV}{\\boldsymbol{V}}\n\\newcommand{\\bv}{\\boldsymbol{v}}\n\\newcommand{\\bY}{\\boldsymbol{Y}}\n\\newcommand{\\bA}{\\boldsymbol{A}}\n\\newcommand{\\bB}{\\boldsymbol{B}}\n\\newcommand{\\bR}{\\boldsymbol{R}}\n\\newcommand{\\bM}{\\boldsymbol{M}}\n\\newcommand{\\bI}{\\boldsymbol{I}}\n\\newcommand{\\bC}{\\boldsymbol{C}}\n\\newcommand{\\bW}{\\boldsymbol{W}}\n\\newcommand{\\bw}{\\boldsymbol{w}}\n\\newcommand{\\bd}{\\boldsymbol{d}}\n\\newcommand{\\bT}{\\boldsymbol{T}}\n\\newcommand{\\bt}{\\boldsymbol{t}}\n\\newcommand{\\bZ}{\\boldsymbol{Z}}\n\\newcommand{\\bX}{\\boldsymbol{X}}\n\\newcommand{\\bz}{\\boldsymbol{z}}\n\\newcommand{\\by}{\\boldsymbol{y}}\n\\newcommand{\\br}{\\boldsymbol{r}}\n\\newcommand{\\bp}{\\boldsymbol{p}}\n\\newcommand{\\bb}{\\boldsymbol{b}}\n\\newcommand{\\bZero}{\\boldsymbol{0}}\n\\newcommand{\\bOne}{\\boldsymbol{1}}\n\\]\nThe goal of the nonprobsvy R package is to carry out statistical inferences with nonprobability survey samples (including big data) when auxiliary information from external sources like probability samples or population totals/means are available. It should be noted that there are several packages that allow for correcting selection bias in non-probability samples such as GJRM (Marra et al. 2017), NonProbEst (Rueda et al. 2020) or even sampling (Tillé and Matei 2021). However, these packages do not implement state-of-the-art approaches recently proposed in the literature: Chen et al. (2020), Yang et al. (2020), Wu (2022) nor use survey package [Lumley 2004] for inference.\nWe implemented propensity score weighting (e.g. with calibration constraints), mass imputation (e.g. nearest neighbor) and doubly robust estimators that take into account minimization of the asymptotic bias of the population mean estimators, variable selection or overlap between random and nonrandom sample. The package uses survey package functionalities when a probability sample is available. Probability sampling methods are adopted by official statistics and researchers in many areas, such as social or health science. Probability samples are collected under known sampling design and therefore highly-representative for the target population. On the other hand it is known that this type of sampling is expensive and subject to high non-response rates, that increases every year (source here). With advance new technology and big data sources, nonprobability samples become more and more popular in statistical inference. They contain rich information about target population and provide cost-time efficiency in comparison to probability samples. On the other hand selection mechanism is not known for nonprobability samples and therefore it is a great misuse to say that this sample are representative for the target population.\nA popular framework in data integration is to assume that auxiliary variables on the same population are available for probabiliy samples or population totals from external sources and therefore one can combine these information with biased nonprobability sample. In this book we perform and expand known methods for statistical inference using described framework for data integration. We can treat data integration as a missing data problem with following structure\nInstead of sample \\(S_B\\) we can consider vector of population totals/means, which will be the subject of consideration later in the book. Under the setting from the table above we are going to develop statistical methods of inference, that require certain assumptions on the outcome or selection models, and sampling mechanism for \\(S_B\\) as well. Structure of the book is as follow: in the chapters 2, 3 and 4 we describe recommended methods for the issue presented. In the chapter 5 we propose techniques of variables selection for high-dimensional data, which can reduce bias of the estimator. In the last chapters, we present simulation results performed with the help of the package under development, as well as a summary and consider the methods worthy of further work."
  },
  {
    "objectID": "ipw.html",
    "href": "ipw.html",
    "title": "3  Inverse probability weighting",
    "section": "",
    "text": "\\[\n\\newcommand{\\bSigma}{\\boldsymbol{\\Sigma}}\n\\newcommand{\\bOmega}{\\boldsymbol{\\Omega}}\n\\newcommand{\\bTheta}{\\boldsymbol{\\Theta}}\n\\newcommand{\\bPi}{\\boldsymbol{\\Pi}}\n\\newcommand{\\bbeta}{\\boldsymbol{\\beta}}\n\\newcommand{\\balpha}{\\boldsymbol{\\alpha}}\n\\newcommand{\\brho}{\\boldsymbol{\\rho}}\n\\newcommand{\\beps}{\\boldsymbol{\\epsilon}}\n\\newcommand{\\blambda}{\\boldsymbol{\\lambda}}\n\\newcommand{\\bgamma}{\\boldsymbol{\\gamma}}\n\\newcommand{\\btheta}{\\boldsymbol{\\theta}}\n\\newcommand{\\bmu}{\\boldsymbol{\\mu}}\n\\newcommand{\\bpi}{\\boldsymbol{\\pi}}\n\\newcommand{\\bphi}{\\boldsymbol{\\phi}}\n\\newcommand{\\bPhi}{\\boldsymbol{\\Phi}}\n\\newcommand{\\boldeta}{\\boldsymbol{\\eta}}\n\\newcommand{\\bx}{\\boldsymbol{x}}\n\\newcommand{\\bD}{\\boldsymbol{D}}\n\\newcommand{\\bV}{\\boldsymbol{V}}\n\\newcommand{\\bv}{\\boldsymbol{v}}\n\\newcommand{\\bY}{\\boldsymbol{Y}}\n\\newcommand{\\bA}{\\boldsymbol{A}}\n\\newcommand{\\bB}{\\boldsymbol{B}}\n\\newcommand{\\bR}{\\boldsymbol{R}}\n\\newcommand{\\bM}{\\boldsymbol{M}}\n\\newcommand{\\bI}{\\boldsymbol{I}}\n\\newcommand{\\bC}{\\boldsymbol{C}}\n\\newcommand{\\bW}{\\boldsymbol{W}}\n\\newcommand{\\bw}{\\boldsymbol{w}}\n\\newcommand{\\bd}{\\boldsymbol{d}}\n\\newcommand{\\bT}{\\boldsymbol{T}}\n\\newcommand{\\bt}{\\boldsymbol{t}}\n\\newcommand{\\bZ}{\\boldsymbol{Z}}\n\\newcommand{\\bX}{\\boldsymbol{X}}\n\\newcommand{\\bz}{\\boldsymbol{z}}\n\\newcommand{\\by}{\\boldsymbol{y}}\n\\newcommand{\\br}{\\boldsymbol{r}}\n\\newcommand{\\bp}{\\boldsymbol{p}}\n\\newcommand{\\bb}{\\boldsymbol{b}}\n\\newcommand{\\bZero}{\\boldsymbol{0}}\n\\newcommand{\\bOne}{\\boldsymbol{1}}\n\\]"
  },
  {
    "objectID": "ipw.html#motivation-and-assumptions",
    "href": "ipw.html#motivation-and-assumptions",
    "title": "3  Inverse probability weighting",
    "section": "3.1 Motivation and assumptions",
    "text": "3.1 Motivation and assumptions\nThe biggest drawback of the nonprobability sampling is unknown selection mechanism for a unit to be included in the sample. This is why we talk about so called “biased sample” problem. Inverse probabiliy approach is based on assumption that reference probabiliy sample (\\(S_B\\)) is available and therefore we can estimate propensity score of selection mechanism.\nLet \\(\\mathcal{U}=\\{1,2, \\ldots, N\\}\\) represent the finite population with N units and \\(\\left\\{\\left(\\bx_i, y_i\\right), i \\in \\mathcal{S}_{\\mathrm{A}}\\right\\}\\) and \\(\\{\\left(\\bx_i, d_i^B), i \\in \\mathcal{S}_{\\mathrm{B}}\\right\\}\\) be the datasets from non-probability and probability samples respectively, where \\(D_i^B\\) are design weights for probability sample. Let \\(\\bY = \\left(Y_1, Y_2, \\cdots, Y_{n_{A}}\\right)^{T}\\) and let \\(\\bX_A\\), \\(\\bX_B\\) denote an \\(n \\times \\left( p+1 \\right)\\) design matrices for samples \\(S_A\\) and \\(S_B\\) of the form \\[\n\\begin{equation*}\n    \\bX_A =\n    \\begin{bmatrix}\n        1 & x_{11} & x_{12} & \\cdots & x_{1p} \\\\\n        1 & x_{21} & x_{22} & \\cdots & x_{2p} \\\\\n        \\vdots & \\vdots & \\ddots & \\vdots \\\\\n        1 &  x_{n_{A}1} & x_{n_{A}2} & \\cdots & x_{n_{A}p} \\\\\n    \\end{bmatrix}\n\\end{equation*}\n\\]\n\\[\n\\begin{equation*}\n    \\bX_B =\n    \\begin{bmatrix}\n        1 & x_{11} & x_{12} & \\cdots & x_{1p} \\\\\n        1 & x_{21} & x_{22} & \\cdots & x_{2p} \\\\\n         \\vdots & \\vdots & \\ddots & \\vdots \\\\\n        1 & x_{n_{B}1} & x_{n_{B}2} & \\cdots & x_{n_{B}p} \\\\\n    \\end{bmatrix}\n\\end{equation*}\n\\\\\n\\]\nFollowing assumptions are required for this model:\n\nThe selection indicator \\(R_i\\) and the response variable \\(y_i\\) are independent given the set of covariates \\(\\bx_i\\).\nAll units have a nonzero propensity score, that is, \\(\\pi_i^A > 0\\) for all \\(i\\).\nThe indicator variables \\(R_i^A\\) and \\(R_j^A\\) are independent for given \\(\\bx_i\\) and \\(\\bx_j\\) for \\(i \\neq j\\).\n\nThere are few methods for inclusion probability estimation for \\(S_A\\). The first one is based on Maximum Likelihood approach but with correction for access to a random sample rather than the entire population. On can also construct calibration equation, so that estimated propensity weights allow to reproduce the whole population. Let us to perform technical details of these methods."
  },
  {
    "objectID": "ipw.html#maximum-likelihood-estimation",
    "href": "ipw.html#maximum-likelihood-estimation",
    "title": "3  Inverse probability weighting",
    "section": "3.2 Maximum likelihood estimation",
    "text": "3.2 Maximum likelihood estimation\nSuppose that propensity score can be modelled parametrically as \\(\\mathbb{P}\\left(R_i=1 \\mid \\bx_i\\right) = \\pi(\\bx_{i}, \\btheta_{0})\\). The maximum likelihood estimator is computed as \\(\\hat{\\pi}_{i}^{A} = \\pi(\\bx_{i}, \\hat{\\btheta}_{0})\\), where \\(\\hat{\\btheta}_{0}\\) is the maximizer of the following log-likelihood function:\n\\[\n    \\begin{split}\n\\ell(\\boldsymbol{\\theta}) & =\\sum_{i=1}^N\\left\\{R_i \\log \\pi_i^{\\mathrm{A}}+\\left(1-R_i\\right) \\log \\left(1-\\pi_i^{\\mathrm{A}}\\right)\\right\\} \\\\ & =\\sum_{i \\in \\mathcal{S}_{\\mathrm{A}}} \\log \\left\\{\\frac{\\pi\\left(\\boldsymbol{x}_i, \\boldsymbol{\\theta}\\right)}{1-\\pi\\left(\\boldsymbol{x}_i, \\boldsymbol{\\theta}\\right)}\\right\\}+\\sum_{i=1}^N \\log \\left\\{1-\\pi\\left(\\boldsymbol{x}_i, \\boldsymbol{\\theta}\\right)\\right\\}\n    \\end{split}\n\\]\nSince we do not observe \\(\\bx_i\\) for all units, Yilin Chen, Pengfei Li & Changbao Wu presented following log-likelihood function is subject to data integration basing on samples \\(S_A\\) and \\(S_B\\). They proposed logistic regression model with \\(\\pi(\\bx_{i}, \\btheta) = \\frac{\\exp(\\bx_{i}^{\\top}\\btheta)}{\\exp(\\bx_{i}^{\\top}\\btheta) + 1}\\) in order to estimate \\(\\btheta\\). We expanded this approach on probit regression and complementary log-log model. For the sake of accuracy, let us recall that the probit and cloglog models are based on the assumption that model takes the form \\(\\pi(\\bx_{i},\\btheta) = \\Phi(\\bx_{i}^{\\top}\\btheta)\\) and \\(\\pi(\\bx_{i}, \\btheta) = 1 - \\exp(-\\exp(\\bx_{i}^{\\top}\\btheta))\\) respectively. \\[\n\\begin{equation} \\label{eq-1}\n    \\ell^{*}(\\btheta) = \\sum_{i \\in S_{A}}\\log \\left\\{\\frac{\\pi(\\bx_{i}, \\btheta)}{1 - \\pi(\\bx_{i},\\btheta)}\\right\\} + \\sum_{i \\in S_{B}}d_{i}^{B}\\log\\{1 - \\pi({\\bx_{i},\\btheta})\\}\n\\end{equation}\n\\tag{3.1}\\] In order to maximize function from (3.1) equate its derivative (gradient) to zero. This will give us p+1 nonlinear equations with respect to \\(\\btheta\\), which will have no explicit solutions. To solve the given system of equations, the Newton-Raphson algorithm can be used. This method also requires the calculation of the second derivative of the log-likelihood function (hessian). By expanding the function (3.1) into a Taylor series, it can be shown that \\(\\hat{\\btheta}\\) can be found by using the following iterative method: \\[\n\\btheta^{(m)} = \\btheta^{(m-1)} - \\{H(\\btheta^{(m-1)}\\}^{-1}U(\\btheta^{(m-1})),\n\\] where \\(\\operatorname{H}\\) - hessian, \\(\\operatorname{U}\\) - gradient. This will give us a convergent MLE estimator (for \\(m \\rightarrow \\infty\\)).\nIn the nonprobsvy package, in addition to the Newton-Raphson method, you can also use the Nelder-Mead and Broyden-Fletcher-Goldfarb-Shanno methods implemented in the optim and maxLik functions.\nFrom the chain rule for counting derivatives, we know that \\[\n\\begin{equation*}\n    \\frac{\\partial \\ell}{\\partial \\boldsymbol{\\theta}}=\\frac{\\partial \\ell}{\\partial p} \\frac{\\partial p}{\\partial \\boldsymbol{\\eta}} \\frac{\\partial \\boldsymbol{\\eta}}{\\partial \\boldsymbol{\\theta}}=\\frac{\\partial \\ell}{\\partial p} \\frac{\\partial p}{\\partial \\boldsymbol{\\eta}} \\boldsymbol{X}\n\\end{equation*}\n\\] where \\(\\eta=\\boldsymbol{X}^{\\top} \\boldsymbol{\\theta}\\), \\(\\frac{\\partial \\ell}{\\partial \\boldsymbol{\\theta}}=\\boldsymbol{U} \\boldsymbol{X}\\) (\\(\\boldsymbol{U} = \\frac{\\partial \\ell}{\\partial {\\eta}}\\)) and \\(\\frac{\\partial^2 \\ell}{\\partial \\boldsymbol{\\theta} \\partial \\boldsymbol{\\theta}^{\\top}}= \\boldsymbol{X}^{\\top} \\boldsymbol{W} \\boldsymbol{X}\\) (\\(\\boldsymbol{W} = \\frac{\\partial^2 \\ell}{\\partial {\\eta}}\\)). Using this rule In the following subsections we present the full derivation of the MLE n the following subsections. Calculations include technical differences depending on the assumed model for the propensity score.\n\n3.2.1 Logistic regression\nLog-likelihood function with logistic regression is given by \\[\n\\ell^{*}(\\btheta) = \\sum_{i \\in S_A}\\bx_{i}^{\\top}\\btheta - \\sum_{i \\in S_B}d_{i}^{B}\\log\\{1 + \\exp(\\bx_{i}^{\\top}\\btheta)\\}\n\\] with analytical gradient and hessian given by \\[\n\\frac{\\partial \\ell^*}{\\partial\\btheta} = \\sum_{i \\in S_{A}}\\bx_{i} - \\sum_{i \\in S_{B}}d_{i}^{B}\\pi(\\bx_{i}, \\btheta)\\bx_{i}\n\\] and \\[\n    \\frac{\\partial^{2} \\ell^{*}}{\\partial\\btheta^{T} \\partial\\btheta} =- \\sum_{i \\in S_B}d_i^B\\pi(\\bx_i,\\btheta)(1 - \\pi(\\bx_i,\\btheta))\\bx_i\\bx_i^{\\top} = \\bX_B^{\\top}\\operatorname{\\bW}_{B}\\bX_B,\n\\] respectively, where \\[\n\\begin{align*}\n    \\operatorname{\\bW}_{B} =\n    diag & \\left(-d_1^B\\pi(\\bx_{1},\\btheta)(1 - \\pi(\\bx_{1},\\btheta)), -d_2^B\\pi(\\bx_{2},\\btheta)(1 - \\pi(\\bx_{2},\\btheta)), \\right. \\\\\n     & \\left. \\ldots, -d_{n_{B}}^{B}\\pi(\\bx_{n_{B}},\\btheta)(1 - \\pi(x_{n_{B}},\\btheta))\\right).\n\\end{align*}\n\\]\n\n\n3.2.2 Complementary log-log regression\nSimilarly, log-likelihood function has form of \\[\n\\ell^{*}(\\btheta) = \\sum_{i \\in S_{A}}\\left\\{\\log\\{1 - \\exp(-\\exp(\\bx_{i}^{\\top}\\btheta))\\} + \\exp(\\bx_{i}^{\\top}\\btheta)\\right\\} - \\sum_{i \\in S_{B}} d_{i}^{B}\\exp(\\bx_{i}^{\\top}\\btheta)\n\\] with analytical gradient and hessian equal to \\[\n    \\frac{\\partial \\ell^*}{\\partial\\btheta} = \\sum_{i \\in S_{A}}\\frac{\\exp(\\bx_{i}^{\\top}\\btheta)\\bx_{i}}{\\pi(\\bx_{i}, \\btheta)} - \\sum_{i \\in S_{B}}d_{i}^{B}\\exp(\\bx_{i}^{T}\\btheta)\\bx_{i}\n\\] and \\[\n    \\begin{split}\n    \\frac{\\partial^{2} \\ell^{*}}{\\partial\\btheta^{T} \\partial\\btheta} & = \\sum_{i \\in S_A} \\frac{\\exp(\\bx_{i}^{\\top}\\btheta)}{\\pi(\\bx_{i}, \\btheta)} \\left\\{1 - \\frac{\\exp(\\bx_{i}^{\\top}\\btheta)}{\\pi(\\bx_{i}, \\btheta)} + \\exp(\\bx_{i}^{\\top}\\btheta)\\right\\}\\bx_i\\bx_i^{\\top} - \\sum_{i \\in S_B}d_i^B\\exp (\\bx_{i}^{\\top}\\btheta)\\bx_i\\bx_i^{\\top} \\\\ & = \\bX_A^{\\top}\\operatorname{\\bW}_{Ac}\\bX_A - \\bX_B^{\\top}\\operatorname{\\bW}_{Bc}\\bX_B,\n    \\end{split}\n\\] respectively, where \\[\n\\begin{align*}\n    \\operatorname{\\bW}_{Ac} =  Diag & \\left(\\frac{\\exp(\\bx_{1}^{\\top}\\btheta)}{\\pi(\\bx_{1}, \\btheta)} \\left\\{1 - \\frac{\\exp(\\bx_{1}^{\\top}\\btheta)}{\\pi(\\bx_{1}, \\btheta)} + \\exp(\\bx_{1}^{\\top}\\btheta)\\right\\}, \\right.\n    \\\\\n    & \\left. \\frac{\\exp(\\bx_{2}^{\\top}\\btheta)}{\\pi(\\bx_{2}, \\btheta)} \\left\\{1 - \\frac{\\exp(\\bx_{2}^{\\top}\\btheta)}{\\pi(\\bx_{2}, \\btheta)} + \\exp(\\bx_{2}^{\\top}\\btheta)\\right\\}, \\right.\n    \\\\\n    & \\left. \\ldots, \\right.\n    \\\\\n    & \\left. \\frac{\\exp(\\bx_{n_A}^{\\top}\\btheta)} {\\pi(\\bx_{n_A}, \\btheta)} \\left\\{1 - \\frac{\\exp(\\bx_{n_A}^{\\top}\\btheta)}{\\pi(\\bx_{n_A}, \\btheta)} + \\exp(\\bx_{n_A}^{\\top}\\btheta)\\right\\} \\right)\n\\end{align*}\n\\] and \\[\n\\begin{align*}\n    \\operatorname{\\bW}_{Bc} = Diag \\left(d_1^B\\exp (\\bx_{1}^{\\top}\\btheta), d_2^B\\exp (\\bx_{2}^{\\top}\\btheta), \\ldots, d_{n_B}^B\\exp (\\bx_{n_{B}}^{\\top}\\btheta)\\right).\n\\end{align*}\n\\]\n\n\n3.2.3 Probit regression\nFor probit model calculations are as follow \\[\n\\begin{align*}\n    \\begin{split}\n        \\ell^{*}(\\btheta) & = \\sum_{i \\in S_{A}}\\log\\left\\{\\frac{\\Phi(\\bx_{i}^{\\top}\\btheta)}{1 - \\Phi(\\bx_{i}^{\\top}\\btheta)}\\right\\} + \\sum_{i \\in S_{B}}d_{i}^{B}\\log\\{1 - \\Phi(\\bx_{i}^{\\top}\\btheta)\\}\n    \\end{split}\n\\end{align*}\n\\] with analytical gradient as \\[\n        \\frac{\\partial \\ell^*}{\\partial\\btheta} = \\sum_{i \\in S_A}\\frac{\\phi(\\bx_i^{\\top}\\btheta)}{\\Phi(\\bx_i^{\\top}\\btheta)(1 - \\Phi(\\bx_i^{\\top}\\btheta))}\\bx_i - \\sum_{i \\in S_B}d_i^B\\frac{\\phi(\\bx_i^{\\top}\\btheta)}{1 - \\Phi(\\bx_i^{\\top}\\btheta)}\\bx_i.\n\\] and hessian equals to \\[\n\\begin{align*}\n    \\begin{split}\n\\frac{\\partial^{2} \\ell^{*}}{\\partial\\btheta^{T} \\partial\\btheta} & = \\sum_{i \\in S_A}\\frac{ - \\bx_i^{\\top} \\phi(\\bx_i^{\\top}\\btheta)}{\\Phi(\\bx_i^{\\top}\\btheta)(1 - \\Phi(\\bx_i^{\\top}\\btheta) )}\\bx_i\\bx_i^{\\top} - \\sum_{i \\in S_A}\\frac{\\phi(\\bx_i^{\\top}\\btheta))^{2} \\left(1 - 2\\Phi(\\bx_i^{\\top}\\btheta))\\right)}{\\Phi(\\bx_i^{\\top}\\btheta)^{2}(1 - \\Phi(\\bx_i^{\\top}\\btheta) )^{2}}\\bx_i\\bx_i^{\\top} \\\\ & - \\sum_{i \\in S_B}\\frac{\\bx_i^{\\top}\\btheta \\phi(\\bx_i^{\\top}\\btheta)}{(1 -  \\Phi(\\bx_i^{\\top}\\btheta))}\\bx_i\\bx_i^{\\top} - \\sum_{i \\in S_B} \\frac{\\phi(\\bx_i^{\\top}\\btheta)^{2}}{\\left(1 - \\Phi(\\bx_i^{\\top}\\btheta) \\right)} \\\\ &=     \\bX_A^{\\top}\\operatorname{\\bW}_{Ap}\\bX_A - \\bX_B^{\\top}\\operatorname{\\bW}_{Bp}\\bX_B\n    \\end{split}\n\\end{align*}\n\\] where \\[\n\\begin{align}\n\\operatorname{\\bW}_{Ap} =  Diag & \\left(\\frac{ - \\bx_1^{\\top} \\phi(\\bx_1^{\\top}\\btheta)}{\\Phi(\\bx_1^{\\top}\\btheta)(1 - \\Phi(\\bx_1^{\\top}\\btheta) )}\\bx_1\\bx_1^{\\top} - \\frac{\\phi(\\bx_1^{\\top}\\btheta))^{2} \\left(1 - 2\\Phi(\\bx_1^{\\top}\\btheta))\\right)}{\\Phi(\\bx_1^{\\top}\\btheta)^{2}(1 - \\Phi(\\bx_1^{\\top}\\btheta) )^{2}}\\bx_1\\bx_1^{\\top} \\right.,\n    \\\\\n    & \\left. \\frac{ - \\bx_2^{\\top} \\phi(\\bx_2^{\\top}\\btheta)}{\\Phi(\\bx_2^{\\top}\\btheta)(1 - \\Phi(\\bx_2^{\\top}\\btheta) )}\\bx_2\\bx_2^{\\top} - \\frac{\\phi(\\bx_2^{\\top}\\btheta))^{2} \\left(1 - 2\\Phi(\\bx_2^{\\top}\\btheta))\\right)}{\\Phi(\\bx_2^{\\top}\\btheta)^{2}(1 - \\Phi(\\bx_2^{\\top}\\btheta) )^{2}}\\bx_2\\bx_2^{\\top}, \\right.\n    \\\\\n    & \\left. \\ldots, \\right.\n    \\\\\n    & \\left. \\frac{ - \\bx_{n_A}^{\\top} \\phi(\\bx_{n_A}^{\\top}\\btheta)}{\\Phi(\\bx_{n_A}^{\\top}\\btheta)(1 - \\Phi(\\bx_{n_A}^{\\top}\\btheta) )}\\bx_{n_A}\\bx_{n_A}^{\\top} - \\frac{\\phi(\\bx_{n_A}^{\\top}\\btheta))^{2} \\left(1 - 2\\Phi(\\bx_{n_A}^{\\top}\\btheta))\\right)}{\\Phi(\\bx_{n_A}^{\\top}\\btheta)^{2}(1 - \\Phi(\\bx_{n_A}^{\\top}\\btheta) )^{2}}\\bx_{n_A}\\bx_{n_A}^{\\top}\\right)\n\\end{align}\n\\] and \\[\n\\begin{align}\n\\operatorname{\\bW}_{Bp} = Diag & \\left(\\frac{\\bx_1^{\\top}\\btheta \\phi(\\bx_1^{\\top}\\btheta)}{(1 -  \\Phi(\\bx_1^{\\top}\\btheta))}\\bx_1\\bx_1^{\\top} - \\frac{\\phi(\\bx_1^{\\top}\\btheta)^{2}}{\\left(1 - \\Phi(\\bx_1^{\\top}\\btheta) \\right)}, \\right.\n    \\\\\n    &\n    \\left. \\frac{\\bx_2^{\\top}\\btheta \\phi(\\bx_2^{\\top}\\btheta)}{(1 -  \\Phi(\\bx_2^{\\top}\\btheta))}\\bx_2\\bx_2^{\\top} - \\frac{\\phi(\\bx_2^{\\top}\\btheta)^{2}}{\\left(1 - \\Phi(\\bx_2^{\\top}\\btheta) \\right)}, \\right.\n    \\\\\n    & \\left. \\ldots, \\right.\n    \\\\\n    & \\left. \\frac{\\bx_{N_B}^{\\top}\\btheta \\phi(\\bx_{N_B}^{\\top}\\btheta)}{(1 -  \\Phi(\\bx_{N_B}^{\\top}\\btheta))}\\bx_{N_B}\\bx_{N_B}^{\\top} - \\frac{\\phi(\\bx_{N_B}^{\\top}\\btheta)^{2}}{\\left(1 - \\Phi(\\bx_{N_B}^{\\top}\\btheta) \\right)}\\right)\n\\end{align}\n\\]"
  },
  {
    "objectID": "ipw.html#general-estimating-equations",
    "href": "ipw.html#general-estimating-equations",
    "title": "3  Inverse probability weighting",
    "section": "3.3 General estimating equations",
    "text": "3.3 General estimating equations\nThe pseudo score equations derived from Maximum Likelihood Estimation methods may be replaced by a system of general estimating equations. Let \\(\\operatorname{h}\\left(\\bx\\right)\\) be the smooth function and \\[\n\\begin{equation}\n\\mathbf{U}(\\btheta)=\\sum_{i \\in S_A} \\mathbf{h}\\left(\\mathbf{x}_i, \\btheta\\right)-\\sum_{i \\in S_B} d_i^B \\pi\\left(\\mathbf{x}_i, \\btheta\\right) \\mathbf{h}\\left(\\mathbf{x}_i, \\btheta\\right).\n\\end{equation}\n\\tag{3.2}\\] Under \\(\\operatorname{h}\\left(\\bx_i\\right) = \\bx_i\\) and logistic model for propensity score, Equation (3.2) looks like disorted version of the score equation from MLE method. Then \\[\n    \\mathbf{U}(\\btheta)=\\sum_{i \\in S_A} \\bx_i -\\sum_{i \\in S_B} d_i^B \\pi\\left(\\mathbf{x}_i, \\btheta\\right) \\bx_i.\n\\] and analytical Jacobian is given by \\[\n\\frac{\\partial \\mathbf{U}}{\\partial\\btheta} = - \\sum_{i \\in S_B} d_i^B \\pi_i^A\\left(\\bx_i^{\\mathrm{T}} \\btheta \\right) \\left(1 -  \\pi_i^A\\left(\\bx_i^{\\mathrm{T}} \\btheta \\right)\\right)\\bx_i \\bx_i^{\\mathrm{T}}.\n\\] The second proposed of the smooth function in the literature is \\(\\operatorname{h}\\left(\\bx_i\\right) = \\bx_i / \\pi_i^A\\left(\\bx_i^{\\mathrm{T}} \\btheta \\right)\\), for which the \\(\\operatorname{U}\\)-function takes the following form \\[\n    \\mathbf{U}(\\btheta)=\\sum_{i \\in S_A}  \\bx_i \\pi_i^A\\left(\\bx_i^{\\mathrm{T}} \\btheta \\right)^{-1} -\\sum_{i \\in S_B} d_i^B \\bx_i.\n\\] The most important difference between these two version, however, is the fact that for \\(\\operatorname{h}\\left(\\bx_i\\right) = \\bx_i / \\pi_i^A\\left(\\bx_i^{\\mathrm{T}} \\btheta \\right)\\), \\(\\mathbf{U}(\\btheta)\\) requires only the accessed or estimated population totals for auxiliary variables \\(\\bx\\). This approach can be particularly useful when the values of \\(\\bx\\) at the unit for a probability sample are not available. Generally, the goal is to find solution for following system of equations \\[\n\\begin{equation*}\n    \\sum_{i \\in S_A} \\mathbf{h}\\left(\\mathbf{x}_i, \\btheta\\right) = \\sum_{i \\in S_B} d_i^B \\pi\\left(\\mathbf{x}_i, \\btheta\\right) \\mathbf{h}\\left(\\mathbf{x}_i, \\btheta\\right)\n\\end{equation*}\n\\]\nDerived \\(\\hat{\\btheta}\\) estimated from this model can be less efficient than the one based on MLE approach, moreover, limited empirical results show that the solution of \\(\\mathbf{U}(\\btheta) = \\bZero\\) can be unstable for given \\(\\operatorname{h}\\left(\\bx_i\\right)\\). On the other hand estimating equations based methods extend the propensity model to more restrictive estimation conditions, for example, when a vector of population totals/means is available instead of a sample \\(S_B\\).\nIn total, we have six models for this estimation method depending on the \\(\\operatorname{h}\\)-function and the way propensity score is parameterized. Let us present all of them.\n\n3.3.1 Logistic regression\nAs the one model for logistic regression is presented above, we have equation under \\(\\operatorname{h}\\left(\\bx_i\\right) = \\bx_i \\pi_i^A\\left(\\bx_i^{\\mathrm{T}} \\btheta \\right)^{-1}\\) to consider. Analytical jacobian is given by \\[\n    \\frac{\\partial \\operatorname{U}(\\btheta)}{\\partial \\btheta} = -\\sum_{i \\in S_A} \\frac{1 - \\pi_i^A\\left(\\bx_i^{\\mathrm{T}} \\btheta \\right)}{\\pi_i^A\\left(\\bx_i^{\\mathrm{T}} \\btheta \\right)} \\bx_i \\bx_i^{\\mathrm{T}}.\n\\]\n\n\n3.3.2 Complementary log-log regression\nFor \\(\\operatorname{h}\\left(\\bx_i\\right) = \\bx_i \\pi_i^A\\left(\\bx_i^{\\mathrm{T}} \\btheta \\right)^{-1}\\) analytical jacobian is given by \\[\n    \\frac{\\partial \\operatorname{U}(\\btheta)}{\\partial \\btheta} = - \\sum_{i \\in S_A} \\frac{1 - \\pi_i^A\\left(\\bx_i^{\\mathrm{T}} \\btheta \\right)}{\\pi_i^A\\left(\\bx_i^{\\mathrm{T}} \\btheta \\right)^2} \\exp(\\bx_i^{\\mathrm{T}} \\btheta) \\bx_i \\bx_i^{\\mathrm{T}}\n\\] and \\(\\operatorname{h}\\left(\\bx_i\\right) = \\bx_i\\) we have \\[\n    \\frac{\\partial \\operatorname{U}(\\btheta)}{\\partial \\btheta} = - \\sum_{i \\in S_B} \\frac{1 - \\pi_i^A\\left(\\bx_i^{\\mathrm{T}} \\btheta \\right)}{\\pi_i^B} \\exp \\left(\\bx_i^\\mathrm{T} \\btheta\\right) \\bx_i \\bx_i^{\\mathrm{T}}.\n\\]\n\n\n3.3.3 Probit regression\nSimilarly, for the probit model, under \\(\\operatorname{h}\\left(\\bx_i\\right) = \\bx_i \\pi_i^A\\left(\\bx_i^{\\mathrm{T}} \\btheta \\right)^{-1}\\) analyical jacobian is given by \\[\n    \\frac{\\partial \\operatorname{U}(\\btheta)}{\\partial \\btheta} = - \\sum_{i \\in S_A} \\frac{\\dot{\\pi}_i^A\\left(\\bx_i^{\\mathrm{T}} \\btheta \\right)}{\\pi_i^A\\left(\\bx_i^{\\mathrm{T}} \\btheta \\right)^2} \\bx_i \\bx_i^{\\mathrm{T}}\n\\] and under \\(\\operatorname{h}\\left(\\bx_i\\right) = \\bx_i\\) we have\n\\[\n    \\frac{\\partial \\operatorname{U}(\\partial \\btheta)}{\\btheta} = - \\sum_{i \\in S_B} \\frac{\\dot{\\pi}_i^A\\left(\\bx_i^{\\mathrm{T}} \\btheta \\right)}{\\pi_i^B} \\bx_i \\bx_i^{\\mathrm{T}}.\n\\]"
  },
  {
    "objectID": "ipw.html#population-mean-estimator-and-its-properties",
    "href": "ipw.html#population-mean-estimator-and-its-properties",
    "title": "3  Inverse probability weighting",
    "section": "3.4 Population mean estimator and its properties",
    "text": "3.4 Population mean estimator and its properties\nWith the estimated propensity scores we can consider two approaches for population mean estimation, depending on whether population size is known or not.\n\\[\n\\begin{equation*}\n    \\hat{\\mu}_{IPW1} = \\frac{1}{N} \\sum_{i \\in S_A} \\frac{y_i}{\\hat{\\pi}_i^{A}}\n\\end{equation*}\n\\]\n\\[\n\\begin{equation*}\n    \\hat{\\mu}_{IPW2} = \\frac{1}{\\hat{N}^{A}} \\sum_{i \\in S_A} \\frac{y_i}{\\hat{\\pi}_i^{A}},\n\\end{equation*}\n\\] where \\(\\hat{N^A} = \\sum_{i \\in S_A} \\hat{d}_i^A\\).\nIn the literature (Kim et al 2020) asymptotic properties of the estimators above are obtained in details. In particular main approach is based on Taylor approximation what is performed in the following subsection.\n\n3.4.1 Variance of an estimator\nLet \\(\\boldsymbol{\\eta} = \\left(\\mu, \\btheta^{T}\\right)^{T}\\) be the set of parameters to estimate for inverse probability weighting model. The estimator \\(\\hat{\\boldsymbol{\\eta}} = \\left(\\hat{\\mu}, \\hat{\\btheta}^{T}\\right)^{T}\\) is the solution of joint estimating equations \\(\\boldsymbol{\\Phi}_n(\\boldsymbol{\\eta}) = \\bZero\\). \\[\n\\begin{equation}\n\\boldsymbol{\\Phi}_n(\\boldsymbol{\\eta})=\\left(\\begin{array}{c}\n\\frac{1}{N} \\sum_{i=1}^N\\left[\\frac{R_i\\left(y_i-\\mu\\right)}{\\pi_i^A}+\\Delta \\frac{R_i-\\pi_i^A}{\\pi_i^A}\\right] \\\\\n\\mathbf{U}(\\btheta)\n\\end{array}\\right)=\\bZero,\n\\end{equation}\n\\] where where \\(\\Delta = \\mu\\), if \\(\\hat{\\mu} = \\hat{\\mu}_{IPW1}\\) and \\(\\Delta = 0\\) if \\(\\hat{\\mu} = \\hat{\\mu}_{IPW2}\\). \\(\\mathbf{U}(\\btheta)\\) is objective function corresponding to given way od estimation. For example in case od pseudo maximum likelihood estimation, we have gradient corresponding to the choosen link function. In case of GEE it will be on of considered estimating equations. We have \\(\\mathbb{E} \\left\\{\\boldsymbol{\\Phi}_n(\\boldsymbol{\\eta})\\right\\} = \\bZero\\) when \\(\\boldsymbol{\\eta} = \\boldsymbol{\\eta}_{0} = \\left(\\mu_y, \\btheta_0^{T}\\right)^{T}\\). By applying the first order Taylor expansion around \\(\\boldsymbol{\\eta}_0\\), we further have \\[\n\\begin{equation*}\n\\hat{\\boldsymbol{\\eta}}-\\boldsymbol{\\eta}_0=\\left[\\boldsymbol{\\phi}_n\\left(\\boldsymbol{\\eta}_0\\right)\\right]^{-1} \\boldsymbol{\\Phi}_n\\left(\\boldsymbol{\\eta}_0\\right)+o_p\\left(n_A^{-1 / 2}\\right)=\\left[E\\left\\{\\boldsymbol{\\phi}_n\\left(\\boldsymbol{\\eta}_0\\right)\\right\\}\\right]^{-1} \\boldsymbol{\\Phi}_n\\left(\\boldsymbol{\\eta}_0\\right)+o_p\\left(n_A^{-1 / 2}\\right),\n\\end{equation*}\n\\] where \\(\\boldsymbol{\\phi}_n(\\boldsymbol{\\eta})=\\partial \\boldsymbol{\\Phi}_n(\\boldsymbol{\\eta}) / \\partial \\boldsymbol{\\eta}\\). It follows that \\[\n\\begin{equation}\n\\operatorname{Var}(\\hat{\\boldsymbol{\\eta}})=\\left[E\\left\\{\\boldsymbol{\\phi}_n\\left(\\boldsymbol{\\eta}_0\\right)\\right\\}\\right]^{-1} \\operatorname{Var}\\left\\{\\boldsymbol{\\Phi}_n\\left(\\boldsymbol{\\eta}_0\\right)\\right\\}\\left[E\\left\\{\\boldsymbol{\\phi}_n\\left(\\boldsymbol{\\eta}_0\\right)\\right\\}^{\\top}\\right]^{-1}+o\\left(n_A^{-1}\\right).\n\\end{equation}\n\\] Let us show how to derive this variance-covariance matrix in case of MLE with logistic regression model. Calculations for the rest of the models is available in Appendix and you are welcome to take a look at them. Thus, we have \\[\n\\boldsymbol{\\Phi}_n(\\boldsymbol{\\eta})=\\left(\\begin{array}{c}\n\\frac{1}{N} \\sum_{i=1}^N\\left[\\frac{R_i\\left(y_i-\\mu\\right)}{\\pi_i^A}+\\Delta \\frac{R_i-\\pi_i^A}{\\pi_i^A}\\right] \\\\\n\\frac{1}{N} \\sum_{i=1}^N R_i \\boldsymbol{x}_i-\\frac{1}{N} \\sum_{i \\in \\mathcal{S}_B} d_i^B \\pi_i^A \\boldsymbol{x}_i\n\\end{array}\\right)\n\\] and\n\\[\n\\phi_n(\\boldsymbol{\\eta})=\\frac{1}{N}\\left(\\begin{array}{cc}\n-\\sum_{i=1}^N\\left\\{\\left(1-\\frac{\\Delta}{\\mu}\\right) \\frac{R_i}{\\pi_i^A}+\\frac{\\Delta}{\\mu}\\right\\} & -\\sum_{i=1}^N \\frac{1-\\pi_i^A}{\\pi_i^A} R_i\\left(y_i-\\mu+\\Delta\\right) \\boldsymbol{x}_i^{\\top} \\\\\n\\mathbf{0} & -\\sum_{i \\in \\mathcal{S}_B} d_i^B \\pi_i^A\\left(1-\\pi_i^A\\right) \\boldsymbol{x}_i \\boldsymbol{x}_i^{\\top}\n\\end{array}\\right)\n\\] It can be shown that \\[\n\\left[E\\left\\{\\boldsymbol{\\phi}_n(\\boldsymbol{\\eta})\\right\\}\\right]^{-1}=\\left(\\begin{array}{cc}\n-1 &  \\mathbf{b}^{\\top} \\\\\n\\mathbf{0} & -\\left[\\frac{1}{N} \\sum_{i=1}^N \\pi_i^A\\left(1-\\pi_i^A\\right) \\boldsymbol{x}_i \\boldsymbol{x}_i^{\\top}\\right]^{-1}\n\\end{array}\\right)\n\\] where\n\\[\n\\mathbf{b}^{\\top} =\n\\left\\{N^{-1} \\sum_{i=1}^N\\left(1-\\pi_i^{\\mathrm{A}}\\right) \\left(y_i-\\mu_y + \\Delta\\right) x_i^{\\top}\\right\\}\\left\\{N^{-1} \\sum_{i=1}^N \\pi_i^{\\mathrm{A}}\\left(1-\\pi_i^{\\mathrm{A}}\\right) \\boldsymbol{x}_i x_i^{\\top}\\right\\}^{-1}\n\\]\n\\(\\operatorname{Var}\\left\\{\\boldsymbol{\\Phi}_n\\left(\\boldsymbol{\\eta}_0\\right)\\right\\}\\) can be found using decomposition of \\(\\bPhi_n(\\boldsymbol{\\eta}) = \\bA_1 + \\bA_2\\). Since the probability sample is assumed to be independent on non-probabillity sample, we have \\(\\operatorname{Var}\\left\\{\\boldsymbol{\\Phi}_n\\left(\\boldsymbol{\\eta}_0\\right)\\right\\} = \\operatorname{Var}\\left(\\bA_1\\right) + \\operatorname{Var}\\left(\\bA_2\\right)\\). Let \\[\n\\mathbf{A}_1=\\frac{1}{N} \\sum_{i=1}^N\\left(\\begin{array}{c}\n\\frac{R_i\\left(y_i-\\mu\\right)}{\\pi_i^A}+\\Delta \\frac{R_i-\\pi_i^A}{\\pi_i^A} \\\\\nR_i \\boldsymbol{x}_i-\\pi_i^A \\boldsymbol{x}_i\n\\end{array}\\right), \\quad \\mathbf{A}_2=\\frac{1}{N}\\left(\\begin{array}{c}\n0 \\\\\n\\sum_{i=1}^N \\pi_i^A \\boldsymbol{x}_i-\\sum_{i \\in S_B} d_i^B \\pi_i^A \\boldsymbol{x}_i\n\\end{array}\\right)\n\\]\nWith this division, we have \\(\\operatorname{Var}\\left\\{\\boldsymbol{\\Phi}_n\\left(\\boldsymbol{\\eta}_0\\right)\\right\\}=\\mathbf{V}_1+\\mathbf{V}_2\\) where \\(\\mathbf{V}_1 = Var \\left(A_1\\right)\\) and \\(\\mathbf{V}_2 = Var \\left(A_2\\right)\\). \\(V_1\\) depends only on the model for propensity score and \\(V_2\\) on sampling design for probability sample, both evaluated on \\(\\boldsymbol{\\eta} = \\boldsymbol{\\eta}_0\\). Finally we have \\[\n\\mathbf{V}_1=\\frac{1}{N^2} \\sum_{i=1}^N\\left(\\begin{array}{cc}\n\\left\\{\\left(1-\\pi_i^A\\right) / \\pi_i^A\\right\\}\\left(y_i-\\mu+\\Delta\\right)^2 & \\left(1-\\pi_i^A\\right)\\left(y_i-\\mu+\\Delta\\right) \\boldsymbol{x}_i^{\\top} \\\\\n\\left(1-\\pi_i^A\\right)\\left(y_i-\\mu+\\Delta\\right) \\boldsymbol{x}_i & \\pi_i^A\\left(1-\\pi_i^A\\right) \\boldsymbol{x}_i \\boldsymbol{x}_i^{\\top}\n\\end{array}\\right)\n\\] and \\[\n\\mathbf{V}_2=\\left(\\begin{array}{ll}\n0 & \\mathbf{0}^{\\top} \\\\\n\\mathbf{0} & \\mathbf{D}\n\\end{array}\\right)\n\\] where \\(\\mathbf{D}=N^{-2} V_p\\left(\\sum_{i \\in \\mathcal{S}_B} d_i^B \\pi_i^A \\boldsymbol{x}_i\\right)\\) and is given by \\[\n\\begin{equation}\n{\\mathbf{D}}=\\frac{1}{N^2} \\sum_{i \\in \\mathcal{S}_{\\mathrm{B}}} \\sum_{j \\in \\mathcal{S}_{\\mathrm{B}}} \\frac{\\pi_{i j}^{\\mathrm{B}}-\\pi_i^{\\mathrm{B}} \\pi_j^{\\mathrm{B}}}{\\pi_{i j}^{\\mathrm{B}}} \\frac{{\\pi}_i^{\\mathrm{A}}}{\\pi_i^{\\mathrm{B}}} \\frac{{\\pi}_j^{\\mathrm{A}}}{\\pi_j^{\\mathrm{B}}} \\boldsymbol{x}_i \\boldsymbol{x}_j^{\\top}\n\\end{equation}\n\\] The asymptotic variance for \\(\\mu_{IPW}\\) is the first diagonal element of matrix \\[\n\\left[E\\left\\{\\boldsymbol{\\phi}_n\\left(\\boldsymbol{\\eta}_0\\right)\\right\\}\\right]^{-1} \\operatorname{Var}\\left\\{\\boldsymbol{\\Phi}_n\\left(\\boldsymbol{\\eta}_0\\right)\\right\\}\\left[E\\left\\{\\boldsymbol{\\phi}_n\\left(\\boldsymbol{\\eta}_0\\right)\\right\\}^{\\top}\\right]^{-1}.\n\\]"
  },
  {
    "objectID": "variableselection.html#motivation",
    "href": "variableselection.html#motivation",
    "title": "6  Techniques of variables selection for high-dimensional data",
    "section": "6.1 Motivation",
    "text": "6.1 Motivation\nIn the presence of high-dimensional data, variable selection is important, because it can reduce variablity in estimation resulting from using irrelevant variables for model building. There is a considerable body of literature on variable selection, but little about techniques for data integration that can successfully recognize the strengths and the limitations of each source of data. The selection of variables is the basis of a two-step approach to estimation, where in first one we select important variables and in the second one re-estimate model. For the first step it is proposed penalized logistic regression model for propensity score estimation (Yang et al, 2020), but we expand this approach on complementary log-log and probit models. For a mass imputation based on a parametric model it is considered penalized OLS (Ordinary least squared) method. It is worth mentioning that Yang, Kim and Rui (2020), in their article on this topic, used the SCAD (Smoothly Clipped Absolute Deviation) penalization, but one can uses LASSO (Least Absolute Shrinkage and Selection Operator) and MCP (Minimax Concave Penalty) techniques as well, what will be considered in the next subsection."
  },
  {
    "objectID": "variableselection.html#existed-techniques",
    "href": "variableselection.html#existed-techniques",
    "title": "6  Techniques of variables selection for high-dimensional data",
    "section": "6.2 Existed techniques",
    "text": "6.2 Existed techniques\nLet \\(\\operatorname{U}\\left(\\btheta, \\bbeta\\right)\\) be the join estimating function for \\(\\left(\\btheta, \\bbeta\\right)\\). When p is large, we consider the penalized estimating functions for \\(\\left(\\btheta, \\bbeta\\right)\\) as\n\\[\n\\operatorname{U}^p\\left(\\btheta, \\bbeta\\right) = \\operatorname{U}\\left(\\btheta, \\bbeta\\right) -\\left(\\begin{array}{c}\nq_{\\lambda_\\theta}(|\\btheta|) \\operatorname{sgn}(\\btheta) \\\\\nq_{\\lambda_\\beta}(|\\bbeta|) \\operatorname{sgn}(\\bbeta)\n\\end{array}\\right),\n\\] where \\(q_{\\lambda_{\\theta}}\\) and \\(q_{\\lambda_{\\beta}}\\) are some smooth functions. We let \\(q_{\\lambda}\\left(x\\right) = \\frac{\\partial p_{\\lambda}}{\\partial x}\\), where \\(p_{\\lambda}\\) is some penalization function.\nBefore the full performance of the estimation model with variable selection it is recommended to explain penalization techniques. We focus on proposed function and its derivative, which are particularly crucial. After that we mark some important similarities and differences between these methods.\n\n6.2.1 LASSO\nIt is probably the most popular method for variable selection, which is also known as L1 regularization. \\[\np_{\\lambda}(x) = \\lambda |x|\n\\] and its derivative\n\\[\nq_{\\lambda}(x)= \\begin{cases} - \\lambda & \\text { if }x < 0, \\\\ \\left[-\\lambda, \\lambda\\right] & \\text { if } x = 0 \\\\ \\lambda & \\text { if }x > 0\\end{cases}\n\\]\n\n\n6.2.2 SCAD\n\\[\np_{\\lambda}(x ; \\gamma)= \\begin{cases}\\lambda|x| & \\text { if }|x| \\leq \\lambda, \\\\ \\frac{2 \\gamma \\lambda|x|-x^2-\\lambda^2}{2(\\gamma-1)} & \\text { if } \\lambda<|x|<\\gamma \\lambda \\\\ \\frac{\\lambda^2(\\gamma+1)}{2} & \\text { if }|x| \\geq \\gamma \\lambda\\end{cases}\n\\] and derivative is \\[\nq_{\\lambda}(x ;  \\gamma)= \\begin{cases}\\lambda & \\text { if }|x| \\leq \\lambda \\\\ \\frac{\\gamma \\lambda-|x|}{\\gamma-1} & \\text { if } \\lambda<|x|<\\gamma \\lambda \\\\ 0 & \\text { if }|x| \\geq \\gamma \\lambda\\end{cases}\n\\]\n\n\n6.2.3 MCP\n\\[\np_{\\lambda}(x ; \\gamma)= \\begin{cases}\\lambda|x|-\\frac{x^2}{2 \\gamma}, & \\text { if }|x| \\leq \\gamma \\lambda \\\\ \\frac{1}{2} \\gamma \\lambda^2, & \\text { if }|x|>\\gamma \\lambda\\end{cases}\n\\] and derivative is \\[\nq_\\lambda(x ; \\gamma)= \\begin{cases}\\left(\\lambda-\\frac{|x|}{\\gamma}\\right) \\operatorname{sign}(x), & \\text { if }|x| \\leq \\gamma \\lambda, \\\\ 0, & \\text { if }|x|>\\gamma \\lambda\\end{cases}\n\\]"
  },
  {
    "objectID": "nomenclature.html",
    "href": "nomenclature.html",
    "title": "Appendix B — Nomenclature",
    "section": "",
    "text": "\\[\n\\newcommand{\\bSigma}{\\boldsymbol{\\Sigma}}\n\\newcommand{\\bOmega}{\\boldsymbol{\\Omega}}\n\\newcommand{\\bTheta}{\\boldsymbol{\\Theta}}\n\\newcommand{\\bPi}{\\boldsymbol{\\Pi}}\n\\newcommand{\\bbeta}{\\boldsymbol{\\beta}}\n\\newcommand{\\balpha}{\\boldsymbol{\\alpha}}\n\\newcommand{\\brho}{\\boldsymbol{\\rho}}\n\\newcommand{\\beps}{\\boldsymbol{\\epsilon}}\n\\newcommand{\\blambda}{\\boldsymbol{\\lambda}}\n\\newcommand{\\bgamma}{\\boldsymbol{\\gamma}}\n\\newcommand{\\btheta}{\\boldsymbol{\\theta}}\n\\newcommand{\\bmu}{\\boldsymbol{\\mu}}\n\\newcommand{\\bpi}{\\boldsymbol{\\pi}}\n\\newcommand{\\bphi}{\\boldsymbol{\\phi}}\n\\newcommand{\\bPhi}{\\boldsymbol{\\Phi}}\n\\newcommand{\\boldeta}{\\boldsymbol{\\eta}}\n\\newcommand{\\bx}{\\boldsymbol{x}}\n\\newcommand{\\bD}{\\boldsymbol{D}}\n\\newcommand{\\bV}{\\boldsymbol{V}}\n\\newcommand{\\bv}{\\boldsymbol{v}}\n\\newcommand{\\bY}{\\boldsymbol{Y}}\n\\newcommand{\\bA}{\\boldsymbol{A}}\n\\newcommand{\\bB}{\\boldsymbol{B}}\n\\newcommand{\\bR}{\\boldsymbol{R}}\n\\newcommand{\\bM}{\\boldsymbol{M}}\n\\newcommand{\\bI}{\\boldsymbol{I}}\n\\newcommand{\\bC}{\\boldsymbol{C}}\n\\newcommand{\\bW}{\\boldsymbol{W}}\n\\newcommand{\\bw}{\\boldsymbol{w}}\n\\newcommand{\\bd}{\\boldsymbol{d}}\n\\newcommand{\\bT}{\\boldsymbol{T}}\n\\newcommand{\\bt}{\\boldsymbol{t}}\n\\newcommand{\\bZ}{\\boldsymbol{Z}}\n\\newcommand{\\bX}{\\boldsymbol{X}}\n\\newcommand{\\bz}{\\boldsymbol{z}}\n\\newcommand{\\by}{\\boldsymbol{y}}\n\\newcommand{\\br}{\\boldsymbol{r}}\n\\newcommand{\\bp}{\\boldsymbol{p}}\n\\newcommand{\\bb}{\\boldsymbol{b}}\n\\newcommand{\\bZero}{\\boldsymbol{0}}\n\\newcommand{\\bOne}{\\boldsymbol{1}}\n\\]"
  }
]